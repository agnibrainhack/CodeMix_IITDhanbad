# -*- coding: utf-8 -*-
"""CodeMix13.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/12VtF5lRg1aaKH4DHvLAZuaWaSSOdtu1w
"""

!pip install -q trl
!pip install -q  -U bitsandbytes
!pip install vllm transformers accelerate jsonlines -q

import os
import json
import pandas as pd
import numpy as np
import torch
from pathlib import Path
from dataclasses import dataclass, asdict
from typing import Dict, List, Optional
from collections import defaultdict
from tqdm import tqdm
import warnings
warnings.filterwarnings('ignore')
from google.colab import drive
import os, json, random

import jsonlines
# from unsloth import FastLanguageModel

# Set random seeds for reproducibility
np.random.seed(42)
torch.manual_seed(42)

# ============================================================================
# 1. FOLDER STRUCTURE SETUP
# ============================================================================

def create_project_structure():
    """Create all necessary folders"""
    folders = [
        'data/datasets',
        'data/splits',
        'data/resources',
        'models/checkpoints',
        'outputs/logs',
        'outputs/metrics'
    ]
    for folder in folders:
        Path(folder).mkdir(parents=True, exist_ok=True)
    print("✓ Folder structure created")

create_project_structure()

# ============================================================================
# 2. LINGUISTIC RESOURCES
# ============================================================================

class LinguisticResourceBuilder:
    """Build and save linguistic resources"""

    @staticmethod
    def build_lexicon():
        """Enhanced lexicon with more entries"""
        entries = [
        # Pronouns
        ("I", "मैं", "main", "pron", 0.98),
        ("you", "तुम", "tum", "pron", 0.96),
        ("he", "वह", "woh", "pron", 0.9),
        ("she", "वह", "woh", "pron", 0.9),
        ("we", "हम", "hum", "pron", 0.92),
        ("they", "वे", "ve", "pron", 0.88),
        ("it", "यह", "yeh", "pron", 0.85),
        ("me", "मुझे", "mujhe", "pron", 0.9),
        ("him", "उसे", "use", "pron", 0.86),
        ("her", "उसे", "use", "pron", 0.86),
        ("us", "हमें", "humein", "pron", 0.85),
        ("them", "उन्हें", "unhein", "pron", 0.82),
        ("I", "मैं", "main", "pron", 0.98),
        ("me", "मुझे", "mujhe", "pron", 0.96),
        ("my", "मेरा", "mera", "pron", 0.96),
        ("mine", "मेरा", "mera", "pron", 0.92),
        ("you", "तुम", "tum", "pron", 0.96),
        ("your", "तुम्हारा", "tumhara", "pron", 0.95),
        ("he", "वह", "woh", "pron", 0.90),
        ("she", "वह", "woh", "pron", 0.90),
        ("him", "उसे", "use", "pron", 0.90),
        ("her", "उसे", "use", "pron", 0.90),
        ("his", "उसका", "uska", "pron", 0.88),
        ("its", "इसका", "iska", "pron", 0.85),
        ("we", "हम", "hum", "pron", 0.92),
        ("us", "हमें", "humein", "pron", 0.90),
        ("they", "वे", "ve", "pron", 0.88),
        ("them", "उन्हें", "unhein", "pron", 0.88),
        ("our", "हमारा", "hamara", "pron", 0.90),


        # Common verbs (base forms)
        ("be", "होना", "hona", "verb", 0.99),
        ("am", "हूँ", "hoon", "verb", 0.97),
        ("is", "है", "hai", "verb", 0.98),
        ("are", "हैं", "hain", "verb", 0.96),
        ("was", "था/थी", "tha/thi", "verb", 0.85),
        ("were", "थे/थीं", "the/theen", "verb", 0.82),
        ("have", "है/है", "hai", "verb", 0.95),
        ("has", "है", "hai", "verb", 0.93),
        ("do", "करना", "karna", "verb", 0.95),
        ("did", "किया", "kiya", "verb", 0.85),
        ("say", "कहना", "kehna", "verb", 0.9),
        ("tell", "बताना", "batana", "verb", 0.88),
        ("go", "जाना", "jaana", "verb", 0.94),
        ("come", "आना", "aana", "verb", 0.92),
        ("get", "पाना", "paana", "verb", 0.9),
        ("make", "बनाना", "banana", "verb", 0.88),
        ("know", "जानना", "jaanna", "verb", 0.88),
        ("think", "सोचना", "sochna", "verb", 0.86),
        ("take", "लेना", "lena", "verb", 0.87),
        ("see", "देखना", "dekhna", "verb", 0.9),
        ("want", "चाहना", "chahna", "verb", 0.9),
        ("need", "चाहिए/ज़रूरत", "chahiye/zarurat", "verb", 0.88),
        ("buy", "खरीदना", "khareedna", "verb", 0.85),
        ("sell", "बेचना", "bechna", "verb", 0.7),
        ("work", "काम करना", "kaam karna", "verb", 0.88),
        ("play", "खेलना", "khelna", "verb", 0.78),
        ("sleep", "सोना", "sona", "verb", 0.82),
        ("eat", "खाना", "khana", "verb", 0.9),
        ("drink", "पीना", "peena", "verb", 0.8),
        ("give", "देना", "dena", "verb", 0.88),
        ("take", "लेना", "lena", "verb", 0.87),
        ("call", "पक करना/कॉल करना", "call karna", "verb", 0.85),
        ("ask", "पूछना", "poochna", "verb", 0.86),
        ("help", "मदद करना", "madad karna", "verb", 0.86),
        ("eat", "खाना", "khana", "verb", 0.95),
        ("drink", "पीना", "peena", "verb", 0.92),
        ("walk", "चलना", "chalna", "verb", 0.92),
        ("run", "दौड़ना", "daudna", "verb", 0.90),
        ("sleep", "सोना", "sona", "verb", 0.90),
        ("wake", "जागना", "jaagna", "verb", 0.84),
        ("go", "जाना", "jaana", "verb", 0.95),
        ("come", "आना", "aana", "verb", 0.95),
        ("sit", "बैठना", "baithna", "verb", 0.90),
        ("stand", "खड़ा होना", "khada hona", "verb", 0.85),
        ("look", "देखना", "dekhna", "verb", 0.95),
        ("watch", "देखना", "dekhna", "verb", 0.95),
        ("see", "देखना", "dekhna", "verb", 0.95),
        ("buy", "खरीदना", "khareedna", "verb", 0.90),
        ("sell", "बेचना", "bechna", "verb", 0.85),
        ("pay", "भुगतान करना", "bhugtaan karna", "verb", 0.82),
        ("call", "कॉल करना", "call karna", "verb", 0.90),
        ("text", "मैसेज करना", "message karna", "verb", 0.87),
        ("write", "लिखना", "likhna", "verb", 0.92),
        ("read", "पढ़ना", "padhna", "verb", 0.92),
        ("drive", "चलाना", "chalana", "verb", 0.88),
        ("work", "काम करना", "kaam karna", "verb", 0.93),
        ("study", "पढ़ाई करना", "padhai karna", "verb", 0.88),
        ("help", "मदद करना", "madad karna", "verb", 0.92),
        ("start", "शुरू करना", "shuru karna", "verb", 0.89),
        ("finish", "खत्म करना", "khatam karna", "verb", 0.85),
        ("open", "खोलना", "kholna", "verb", 0.87),
        ("close", "बंद करना", "band karna","verb", 0.87),
        ("send", "भेजना", "bhejna", "verb", 0.90),
        ("bring", "लाना", "lana", "verb", 0.90),
        ("give", "देना", "dena", "verb", 0.92),
        ("take", "लेना", "lena", "verb", 0.92),
        ("talk", "बात करना", "baat karna", "verb", 0.93),
        ("speak", "बोलना", "bolna", "verb", 0.92),
        ("understand", "समझना", "samajhna", "verb", 0.90),
        ("need", "ज़रूरत होना", "zaroorat hona", "verb", 0.90),
        ("want", "चाहना", "chahna", "verb", 0.94),

        # Modal verbs / auxiliaries
        ("can", "सकता/सकती", "sakta/sakti", "aux", 0.9),
        ("could", "सकता था", "sakta tha", "aux", 0.6),
        ("will", "गा/गी", "ga/gi", "aux", 0.9),
        ("would", "होगा/होगी", "hoga/hogi", "aux", 0.6),
        ("should", "चाहिए", "chahiye", "aux", 0.7),
        ("may", "सकता है", "sakta hai", "aux", 0.5),
        ("might", "सकता था", "sakta tha", "aux", 0.4),
        ("must", "ज़रूरी है", "zaroori hai", "aux", 0.6),

        # Common nouns (places/people/items)
        ("market", "बाज़ार", "bazaar", "noun", 0.9),
        ("shop", "दुकान", "dukaan", "noun", 0.88),
        ("restaurant", "रेस्टोरेंट/रेस्टोरेंट", "restaurant", "noun", 0.85),
        ("hotel", "होटल", "hotel", "noun", 0.8),
        ("house", "घर", "ghar", "noun", 0.92),
        ("home", "घर", "ghar", "noun", 0.92),
        ("office", "दफ़्तर/ऑफ़िस", "daftar/office", "noun", 0.8),
        ("school", "स्कूल", "school", "noun", 0.85),
        ("college", "कॉलेज", "college", "noun", 0.75),
        ("work", "काम", "kaam", "noun", 0.86),
        ("money", "पैसा", "paisa", "noun", 0.9),
        ("price", "कीमत", "keemat", "noun", 0.86),
        ("ticket", "टिकट", "ticket", "noun", 0.82),
        ("phone", "फोन/मोबाइल", "phone/mobile", "noun", 0.88),
        ("friend", "दोस्त", "dost", "noun", 0.9),
        ("family", "परिवार", "parivaar", "noun", 0.85),
        ("name", "नाम", "naam", "noun", 0.9),
        ("time", "समय", "samay", "noun", 0.9),
        ("day", "दिन", "din", "noun", 0.9),
        ("night", "रात", "raat", "noun", 0.88),
        ("week", "हफ़्ता", "hafta", "noun", 0.75),
        ("month", "माह", "mah", "noun", 0.72),
        ("year", "साल", "saal", "noun", 0.8),
        ("problem", "समस्या", "samasya", "noun", 0.86),
        ("question", "प्रश्न/सवाल", "prashn/sawaal", "noun", 0.85),
        ("answer", "उत्तर", "uttar", "noun", 0.85),
        ("water", "पानी", "paani", "noun", 0.98),
        ("food", "खाना", "khana", "noun", 0.97),
        ("rice", "चावल", "chaawal", "noun", 0.90),
        ("bread", "रोटी", "roti", "noun", 0.90),
        ("egg", "अंडा", "anda", "noun", 0.86),
        ("milk", "दूध", "doodh", "noun", 0.92),
        ("tea", "चाय", "chai", "noun", 0.95),
        ("coffee", "कॉफ़ी", "coffee", "noun", 0.90),
        ("family", "परिवार", "parivaar", "noun", 0.90),
        ("friend", "दोस्त", "dost", "noun", 0.95),
        ("child", "बच्चा", "bachcha", "noun", 0.90),
        ("boy", "लड़का", "ladka", "noun", 0.90),
        ("girl", "लड़की", "ladki", "noun", 0.90),
        ("student", "छात्र", "chhatr", "noun", 0.88),
        ("teacher", "अध्यापक", "adhyapak", "noun", 0.86),
        ("doctor", "डॉक्टर", "doctor", "noun", 0.92),
        ("hospital", "अस्पताल", "aspataal", "noun", 0.90),
        ("shop", "दुकान", "dukaan", "noun", 0.94),
        ("market", "बाज़ार", "bazaar", "noun", 0.95),
        ("mall", "मॉल", "mall", "noun", 0.84),
        ("bus", "बस", "bus", "noun", 0.90),
        ("train", "ट्रेन", "train", "noun", 0.90),
        ("flight", "उड़ान", "udaan", "noun", 0.85),
        ("airport", "हवाई अड्डा", "havaai adda", "noun", 0.85),
        ("city", "शहर", "shahar", "noun", 0.93),
        ("village", "गाँव", "gaav", "noun", 0.86),
        ("road", "सड़क", "sadak", "noun", 0.90),
        ("car", "गाड़ी", "gaadi", "noun", 0.95),
        ("bike", "बाइक", "bike", "noun", 0.92),
        ("bus stop", "बस स्टॉप", "bus stop", "noun", 0.80),
        ("phone", "फ़ोन", "phone", "noun", 0.95),
        ("mobile", "मोबाइल", "mobile", "noun", 0.95),
        ("charger", "चार्जर", "charger", "noun", 0.90),
        ("internet", "इंटरनेट", "internet", "noun", 0.90),

        # Adjectives
        ("good", "अच्छा", "accha", "adj", 0.9),
        ("bad", "बुरा", "bura", "adj", 0.85),
        ("big", "बड़ा", "bada", "adj", 0.8),
        ("small", "छोटा", "chhota", "adj", 0.8),
        ("new", "नया", "naya", "adj", 0.85),
        ("old", "पुराना", "purana", "adj", 0.8),
        ("fast", "तेज़", "tez", "adj", 0.75),
        ("slow", "धीमा", "dheema", "adj", 0.66),
        ("cheap", "सस्ता", "sasta", "adj", 0.78),
        ("expensive", "महंगा", "mehanga", "adj", 0.72),
        ("happy", "खुश", "khush", "adj", 0.82),
        ("sad", "दुखी", "dukhi", "adj", 0.7),
        ("easy", "आसान", "aasan", "adj", 0.8),
        ("difficult", "कठिन", "kathin", "adj", 0.7),
        ("good", "अच्छा", "accha", "adj", 0.99),
        ("bad", "बुरा", "bura", "adj", 0.95),
        ("big", "बड़ा", "bada", "adj", 0.90),
        ("small", "छोटा", "chhota", "adj", 0.90),
        ("old", "पुराना", "purana", "adj", 0.90),
        ("new", "नया", "naya", "adj", 0.95),
        ("cold", "ठंडा", "thanda", "adj", 0.90),
        ("hot", "गरम", "garam", "adj", 0.90),
        ("clean", "साफ़", "saaf", "adj", 0.90),
        ("dirty", "गंदा", "ganda", "adj", 0.90),
        ("nice", "अच्छा", "accha", "adj", 0.90),
        ("fast", "तेज़", "tez", "adj", 0.85),
        ("slow", "धीमा", "dheema", "adj", 0.85),
        ("beautiful", "सुंदर", "sundar", "adj", 0.90),

        # Adverbs & time words
        ("now", "अब", "ab", "adv", 0.92),
        ("then", "फिर", "phir", "adv", 0.8),
        ("today", "आज", "aaj", "adv", 0.9),
        ("tomorrow", "कल", "kal", "adv", 0.9),
        ("yesterday", "कल/बीता कल", "kal/beeta kal", "adv", 0.8),
        ("always", "हमेशा", "hamesha", "adv", 0.8),
        ("never", "कभी नहीं", "kabhi nahi", "adv", 0.78),
        ("often", "अक्सर", "aksar", "adv", 0.72),
        ("sometimes", "कभी-कभी", "kabhi-kabhi", "adv", 0.7),
        ("now", "अब", "ab", "adv", 0.98),
        ("then", "फिर", "phir", "adv", 0.90),
        ("here", "यहाँ", "yahan", "adv", 0.90),
        ("there", "वहाँ", "wahan", "adv", 0.90),
        ("today", "आज", "aaj", "adv", 0.95),
        ("tomorrow", "कल", "kal", "adv", 0.95),
        ("yesterday", "कल", "kal", "adv", 0.90),
        ("very", "बहुत", "bahut", "adv", 0.98),
        ("again", "फिर से", "phir se", "adv", 0.90),
        ("always", "हमेशा", "hamesha", "adv", 0.90),
        ("never", "कभी नहीं", "kabhi nahi", "adv", 0.90),

        # Question words
        ("what", "क्या", "kya", "qw", 0.95),
        ("who", "कौन", "kaun", "qw", 0.9),
        ("where", "कहाँ", "kahan", "qw", 0.9),
        ("when", "कब", "kab", "qw", 0.9),
        ("why", "क्यों", "kyon", "qw", 0.88),
        ("how", "कैसे", "kaise", "qw", 0.92),
        ("which", "कौन सा", "kaun sa", "qw", 0.8),

        # Prepositions & conjunctions
        ("in", "में", "mein", "prep", 0.92),
        ("on", "पर", "par", "prep", 0.9),
        ("at", "पर/में", "par/mein", "prep", 0.88),
        ("for", "के लिए", "ke liye", "prep", 0.9),
        ("with", "के साथ", "ke saath", "prep", 0.88),
        ("from", "से", "se", "prep", 0.85),
        ("about", "के बारे में", "ke baare mein", "prep", 0.8),
        ("and", "और", "aur", "conj", 0.95),
        ("or", "या", "ya", "conj", 0.9),
        ("but", "लेकिन", "lekin", "conj", 0.9),
        ("because", "क्योंकि", "kyonki", "conj", 0.84),
        ("so", "तो", "toh", "conj", 0.82),

        # Numbers (0-20 & tens)
        ("zero", "शून्य", "shoonya", "num", 0.6),
        ("one", "एक", "ek", "num", 0.95),
        ("two", "दो", "do", "num", 0.92),
        ("three", "तीन", "teen", "num", 0.9),
        ("four", "चार", "chaar", "num", 0.88),
        ("five", "पांच", "paanch", "num", 0.88),
        ("six", "छह", "chhah", "num", 0.84),
        ("seven", "सात", "saat", "num", 0.82),
        ("eight", "आठ", "aath", "num", 0.8),
        ("nine", "नौ", "nau", "num", 0.78),
        ("ten", "दस", "das", "num", 0.9),
        ("eleven", "ग्यारह", "gyaarah", "num", 0.6),
        ("twelve", "बारह", "baarah", "num", 0.6),
        ("twenty", "बीस", "bees", "num", 0.6),
        ("thirty", "तीस", "tees", "num", 0.5),
        ("hundred", "सौ", "sau", "num", 0.6),
        ("thousand", "हज़ार", "hazaar", "num", 0.55),

        # Days & Months (common)
        ("monday", "सोमवार", "somvaar", "date", 0.5),
        ("tuesday", "मंगलवार", "mangalvaar", "date", 0.5),
        ("wednesday", "बुधवार", "budhvaar", "date", 0.5),
        ("thursday", "गुरुवार", "guruvaar", "date", 0.5),
        ("friday", "शुक्रवार", "shukravaar", "date", 0.5),
        ("saturday", "शनिवार", "shanivaar", "date", 0.5),
        ("sunday", "रविवार", "ravivaar", "date", 0.5),
        ("january", "जनवरी", "janvari", "date", 0.4),
        ("february", "फरवरी", "farvari", "date", 0.4),
        ("march", "मार्च", "maarch", "date", 0.4),
        ("april", "अप्रैल", "aprail", "date", 0.4),
        ("may", "मई", "mai", "date", 0.4),
        ("june", "जून", "joon", "date", 0.4),
        ("july", "जुलाई", "julai", "date", 0.4),
        ("august", "अगस्त", "agast", "date", 0.4),
        ("september", "सितंबर", "sitambar", "date", 0.4),
        ("october", "अक्टूबर", "aktoobar", "date", 0.4),
        ("november", "नवंबर", "navambar", "date", 0.4),
        ("december", "दिसंबर", "disambar", "date", 0.4),

        # Greetings & politeness
        ("hello", "नमस्ते/हेलो", "namaste/hello", "greet", 0.95),
        ("hi", "हाय/हैलो", "hi/hello", "greet", 0.9),
        ("bye", "अलविदा/बाय", "alvida/bye", "greet", 0.85),
        ("thanks", "धन्यवाद/थैंक्स", "dhanyavaad/thanks", "greet", 0.9),
        ("thank you", "धन्यवाद", "dhanyavaad", "greet", 0.95),
        ("please", "कृपया/प्लीज़", "kripya/please", "polite", 0.9),
        ("sorry", "माफ़ कीजिए/सॉरी", "maaf kijiye/sorry", "polite", 0.86),
        ("congrats", "बधाई", "badhai", "greet", 0.7),

        # Discourse markers & colloquial particles (important for code-mix)
        ("yaar", "यार", "yaar", "disc", 0.85),
        ("bhai", "भाई", "bhai", "disc", 0.82),
        ("na", "ना", "na", "disc", 0.8),
        ("toh", "तो", "toh", "disc", 0.78),
        ("arre", "अरे", "arre", "disc", 0.75),
        ("achha", "अच्छा", "achha", "disc", 0.72),
        ("bas", "बस", "bas", "disc", 0.7),
        ("chalo", "चलो", "chalo", "disc", 0.75),
        ("dekho", "देखो", "dekho", "disc", 0.72),
        ("suna", "सुना", "suna", "disc", 0.6),
        ("yaar", "यार", "yaar", "disc", 0.95),
        ("bhai", "भाई", "bhai", "disc", 0.94),
        ("arre", "अरे", "arre", "disc", 0.92),
        ("acha", "अच्छा", "accha", "disc", 0.90),
        ("toh", "तो", "toh", "disc", 0.90),
        ("bas", "बस", "bas", "disc", 0.90),
        ("haan", "हाँ", "haan", "disc", 0.98),
        ("nahi", "नहीं", "nahi", "disc", 0.98),
        ("pakka", "पक्का", "pakka", "disc", 0.90),
        ("mast", "मस्त", "mast","disc", 0.90),
        ("scene", "सीन", "scene", "disc", 0.88),
        ("vibe", "वाइब", "vibe", "disc", 0.85),

        # E-commerce & tech terms
        ("order", "ऑर्डर/आदेश", "order/aadesh", "ecom", 0.86),
        ("delivery", "डिलीवरी", "delivery", "ecom", 0.82),
        ("refund", "रिफंड/वापसी", "refund/vapsi", "ecom", 0.6),
        ("discount", "छूट", "chhoot", "ecom", 0.8),
        ("review", "समीक्षा/रिव्यू", "sameeksha/review", "ecom", 0.7),
        ("rating", "रेटिंग", "rating", "ecom", 0.65),
        ("checkout", "चेकआउट", "checkout", "ecom", 0.6),
        ("account", "खाता", "khata", "tech", 0.8),
        ("password", "पासवर्ड", "password", "tech", 0.75),
        ("login", "लॉगिन", "login", "tech", 0.74),
        ("logout", "लॉगआउट", "logout", "tech", 0.6),
        ("app", "ऐप", "app", "tech", 0.8),
        ("website", "वेबसाइट", "website", "tech", 0.7),

        # Health & common service words
        ("doctor", "डॉक्टर", "doctor", "noun", 0.8),
        ("hospital", "अस्पताल", "aspataal", "noun", 0.75),
        ("medicine", "दवा", "dawa", "noun", 0.8),
        ("appointment", "नियुक्ति/अपॉइंटमेंट", "appointment", "noun", 0.6),
        ("symptom", "लक्षण", "lakshan", "noun", 0.55),

        # Emotions & evaluative terms
        ("love", "प्यार", "pyaar", "noun", 0.88),
        ("hate", "नफ़रत", "nafrat", "verb", 0.6),
        ("like", "पसंद", "pasand", "verb", 0.86),
        ("dislike", "नापसंद", "napasand", "verb", 0.6),
        ("excited", "उत्साहित", "utsahit", "adj", 0.65),

        # Safety / social terms
        ("police", "पुलिस", "police", "noun", 0.6),
        ("government", "सरकार", "sarkaar", "noun", 0.7),
        ("law", "कानून", "kanoon", "noun", 0.6),
        ("vote", "वोट", "vote", "noun", 0.55),

        # Random common verbs & nouns useful for conversational mixing
        ("wait", "रुको/इंतज़ार करो", "ruko/intezaar karo", "verb", 0.82),
        ("stop", "रुको/बंद करो", "ruko/band karo", "verb", 0.78),
        ("start", "शुरू करो", "shuru karo", "verb", 0.76),
        ("finish", "खत्म", "khatam", "verb", 0.75),
        ("open", "खोलना", "kholna", "verb", 0.8),
        ("close", "बंद करना", "band karna", "verb", 0.78),
        ("read", "पढ़ना", "padhna", "verb", 0.8),
        ("write", "लिखना", "likhna", "verb", 0.78),
        ("email", "ईमेल", "email", "noun", 0.7),
        ("message", "संदेश/मैसेज", "sandesh/message", "noun", 0.75),

        # Polite imperative phrases
        ("please wait", "कृपया प्रतीक्षा करें", "kripya pratiksha karein", "polite", 0.75),
        ("please help", "कृपया मदद करें", "kripya madad karein", "polite", 0.75),
        ("call me", "मुझे बुलाओ/कॉल करो", "mujhe bulao/call karo", "verb", 0.72),


        #bigrams and trigrams
        ("good morning", "सुप्रभात", "suprabhat", "bigram", 0.98),
        ("good night", "शुभ रात्रि", "shubh ratri", "bigram", 0.96),
        ("good afternoon", "शुभ दोपहर", "shubh dopahar", "bigram", 0.85),
        ("best wishes", "शुभकामनाएं", "shubhkaamanaen", "bigram", 0.88),
        ("thank you", "धन्यवाद", "dhanyavaad", "bigram", 0.98),
        ("please wait", "कृपया प्रतीक्षा करें", "kripya pratiksha karein", "bigram", 0.9),
        ("please come", "कृपया आएँ", "kripya aayein", "bigram", 0.9),
        ("excuse me", "क्षमा करें", "kshama karein", "bigram", 0.92),
        ("follow me", "मेरे पीछे आइए", "mere pichhe aayein", "bigram", 0.85),
        ("trust me", "मुझ पर भरोसा करें", "mujh par bharosa karein", "bigram", 0.9),
        ("believe me", "मुझ पर विश्वास करें", "mujh par vishwas karein", "bigram", 0.9),
        ("call me", "मुझे कॉल करें", "mujhe call karein", "bigram", 0.9),
        ("write here", "यहाँ लिखें", "yahan likhein", "bigram", 0.88),
        ("stop here", "यहाँ रुकें", "yahan rukein", "bigram", 0.9),
        ("go straight", "सीधे जाएँ", "seedhe jaayein", "bigram", 0.92),
        ("turn right", "दाएँ मुड़ें", "daayen mudhein", "bigram", 0.9),
        ("turn left", "बाएँ मुड़ें", "baayen mudhein", "bigram", 0.9),
        ("come here", "यहाँ आएँ", "yahan aayein", "bigram", 0.95),

        ("open door", "दरवाज़ा खोलें", "darwaza kholein", "bigram", 0.9),
        ("close door", "दरवाज़ा बंद करें", "darwaza band karein", "bigram", 0.88),
        ("take rest", "आराम करें", "aaraam karein", "bigram", 0.9),
        ("read book", "पुस्तक पढ़ें", "pustak padhein", "bigram", 0.9),
        ("write letter", "पत्र लिखें", "patra likhein", "bigram", 0.85),
        ("pay bill", "बिल चुकाएं", "bill chukaayein", "bigram", 0.9),
        ("clean room", "कमरा साफ करें", "kamra saaf karein", "bigram", 0.88),
        ("cook food", "खाना पकाएँ", "khana pakaayein", "bigram", 0.9),
        ("boil water", "पानी उबालें", "paani ubaalein", "bigram", 0.86),
        ("wash clothes", "कपड़े धोएँ", "kapde dhoyein", "bigram", 0.9),
        ("drive car", "गाड़ी चलाएँ", "gaadi chalaayein", "bigram", 0.9),
        ("lock gate", "गेट बंद करें", "gate band karein", "bigram", 0.85),

        ("big house", "बड़ा घर", "bada ghar", "bigram", 0.9),
        ("small house", "छोटा घर", "chhota ghar", "bigram", 0.9),
        ("fresh air", "शुद्ध हवा", "shuddh hawa", "bigram", 0.8),
        ("clean water", "स्वच्छ पानी", "swachh paani", "bigram", 0.9),
        ("strong man", "ताकतवर आदमी", "taakatvar aadmi", "bigram", 0.85),
        ("young girl", "युवती", "yuvati", "bigram", 0.86),
        ("old man", "बूढ़ा आदमी", "budha aadmi", "bigram", 0.9),
        ("old woman", "बूढ़ी औरत", "budhi aurat", "bigram", 0.9),
        ("delicious food", "स्वादिष्ट भोजन", "swadisht bhojan", "bigram", 0.9),

        ("please have a seat", "कृपया बैठ जाइए", "kripya baith jaiye", "trigram", 0.95),
        ("please close door", "कृपया दरवाज़ा बंद करें", "kripya darwaza band karein", "trigram", 0.9),
        ("please call me", "कृपया मुझे कॉल करें", "kripya mujhe call karein", "trigram", 0.9),
        ("please wait here", "कृपया यहाँ प्रतीक्षा करें", "kripya yahan pratiksha karein", "trigram", 0.95),
        ("please come soon", "कृपया जल्दी आएं", "kripya jaldi aayein", "trigram", 0.9),
        ("please help me", "कृपया मेरी मदद करें", "kripya meri madad karein", "trigram", 0.95),
        ("drink some water", "कुछ पानी पिएं", "kuch paani piyein", "trigram", 0.9),
        ("write your name", "अपना नाम लिखें", "apna naam likhein", "trigram", 0.9),
        ("take your seat", "अपनी सीट लें", "apni seat lein", "trigram", 0.9),
        ("clean your room", "अपना कमरा साफ़ करें", "apna kamra saaf karein", "trigram", 0.88),

        ("go to market", "बाज़ार जाएँ", "bazaar jaayein", "trigram", 0.9),
        ("go to school", "स्कूल जाएँ", "school jaayein", "trigram", 0.9),
        ("go to office", "दफ़्तर जाएँ", "daftar jaayein", "trigram", 0.9),
        ("go to home", "घर जाएँ", "ghar jaayein", "trigram", 0.92),
        ("come to school", "स्कूल आएँ", "school aayein", "trigram", 0.9),
        ("come to office", "दफ़्तर आएँ", "daftar aayein", "trigram", 0.9),
        ("come to home", "घर आएँ", "ghar aayein", "trigram", 0.92),

        ("big house is", "बड़ा घर है", "bada ghar hai", "trigram", 0.85),
        ("small child is", "छोटा बच्चा है", "chhota bachcha hai", "trigram", 0.9),
        ("old woman is", "बूढ़ी औरत है", "budhi aurat hai", "trigram", 0.88),
        ("clean water is", "स्वच्छ पानी है", "swachh paani hai", "trigram", 0.88),
        ("fresh air is", "शुद्ध हवा है", "shuddh hawa hai", "trigram", 0.85),

        ("how are you", "आप कैसे हैं", "aap kaise hain", "trigram", 0.98),
        ("who are you", "आप कौन हैं", "aap kaun hain", "trigram", 0.96),
        ("where are you", "आप कहाँ हैं", "aap kahan hain", "trigram", 0.95),
        ("when will you", "आप कब करेंगे", "aap kab karenge", "trigram", 0.9),
        ("why are you", "आप क्यों हैं", "aap kyon hain", "trigram", 0.9),

        ("please sit down", "कृपया बैठ जाएँ", "kripya baith jaayen", "trigram", 0.95),
        ("please stand up", "कृपया खड़े हो जाएँ", "kripya khade ho jaayen", "trigram", 0.92),
        ("please speak slowly", "कृपया धीरे बोलें", "kripya dheere bolen", "trigram", 0.92),
        ("please write here", "कृपया यहाँ लिखें", "kripya yahan likhen", "trigram", 0.9),
        ("please wait outside", "कृपया बाहर प्रतीक्षा करें", "kripya bahar pratiksha karein", "trigram", 0.9),
        ("please pay attention", "कृपया ध्यान दें", "kripya dhyan den", "trigram", 0.95),
        ("please read carefully", "कृपया ध्यान से पढ़ें", "kripya dhyaan se padhein", "trigram", 0.9),
        ("please walk slowly", "कृपया धीरे चलें", "kripya dheere chaley", "trigram", 0.9),

        ("what is this", "यह क्या है", "yeh kya hai", "trigram", 0.98),
        ("what is that", "वह क्या है", "vah kya hai", "trigram", 0.96),
        ("where is he", "वह कहाँ है", "vah kahan hai", "trigram", 0.95),
        ("where is she", "वह कहाँ है", "vah kahan hai", "trigram", 0.95),
        ("where is water", "पानी कहाँ है", "paani kahan hai", "trigram", 0.92),
        ("where is market", "बाज़ार कहाँ है", "bazaar kahan hai", "trigram", 0.92),
        ("where is school", "स्कूल कहाँ है", "school kahan hai", "trigram", 0.9),
        ("where is railway", "रेलवे कहाँ है", "railway kahan hai", "trigram", 0.88),
        ("who is there", "वहाँ कौन है", "wahan kaun hai", "trigram", 0.9),
        ("how is weather", "मौसम कैसा है", "mausam kaisa hai", "trigram", 0.9),
        ("how is work", "काम कैसा है", "kaam kaisa hai", "trigram", 0.9),

        ("go very slowly", "बहुत धीरे जाएँ", "bahut dheere jaayen", "trigram", 0.88),
        ("go very fast", "बहुत तेज जाएँ", "bahut tez jaayen", "trigram", 0.88),
        ("go straight ahead", "सीधे आगे जाएँ", "seedhe aage jaayen", "trigram", 0.92),
        ("go little ahead", "थोड़ा आगे जाएँ", "thoda aage jaayen", "trigram", 0.9),
        ("go to temple", "मंदिर जाएँ", "mandir jaayen", "trigram", 0.9),
        ("go to market", "बाज़ार जाएँ", "bazaar jaayen", "trigram", 0.9),
        ("go to hospital", "अस्पताल जाएँ", "aspatal jaayen", "trigram", 0.9),
        ("come to home", "घर आएँ", "ghar aayein", "trigram", 0.92),
        ("come to office", "दफ़्तर आएँ", "daftar aayein", "trigram", 0.9),
        ("come with me", "मेरे साथ आइए", "mere saath aayein", "trigram", 0.95),
        ("sit over there", "वहाँ बैठिए", "wahan baithiye", "trigram", 0.92),
        ("stand over there", "वहाँ खड़े रहिए", "wahan khade rahiye", "trigram", 0.9),

        ("this house is", "यह घर है", "yeh ghar hai", "trigram", 0.9),
        ("this room is", "यह कमरा है", "yeh kamra hai", "trigram", 0.9),
        ("this boy is", "यह लड़का है", "yeh ladka hai", "trigram", 0.9),
        ("this girl is", "यह लड़की है", "yeh ladki hai", "trigram", 0.9),
        ("this price is", "यह कीमत है", "yeh keemat hai", "trigram", 0.88),
        ("that man is", "वह आदमी है", "vah aadmi hai", "trigram", 0.9),
        ("that shop is", "वह दुकान है", "vah dukaan hai", "trigram", 0.9),
        ("that place is", "वह स्थान है", "vah sthaan hai", "trigram", 0.85),
        ("that road is", "वह सड़क है", "vah sadak hai", "trigram", 0.9),
        ("that school is", "वह स्कूल है", "vah school hai", "trigram", 0.9),

        ("open that door", "वह दरवाज़ा खोलें", "vah darwaza kholen", "trigram", 0.9),
        ("close that window", "वह खिड़की बंद करें", "vah khidki band karein", "trigram", 0.9),
        ("clean that table", "वह मेज़ साफ करें", "vah mez saaf karein", "trigram", 0.85),
        ("wash these clothes", "ये कपड़े धोएँ", "ye kapde dhoyein", "trigram", 0.9),
        ("boil this water", "यह पानी उबालें", "yeh paani ubaalen", "trigram", 0.9),
        ("fix this issue", "इस समस्या को ठीक करें", "is samasya ko theek karein", "trigram", 0.9),
        ("take this bag", "यह बैग लें", "yeh bag lein", "trigram", 0.9),
        ("bring this here", "इसे यहाँ लाएँ", "ise yahan laayein", "trigram", 0.88),
        ("give me water", "मुझे पानी दें", "mujhe paani den", "trigram", 0.95),
        ("give that book", "वह पुस्तक दें", "vah pustak den", "trigram", 0.88),

        ("come tomorrow morning", "कल सुबह आएँ", "kal subah aayein", "trigram", 0.9),
        ("come tomorrow evening", "कल शाम आएँ", "kal shaam aayein", "trigram", 0.9),
        ("come next week", "अगले सप्ताह आएँ", "agle saptah aayein", "trigram", 0.88),
        ("come next month", "अगले महीने आएँ", "agle mahine aayein", "trigram", 0.86),
        ("come next year", "अगले वर्ष आएँ", "agle varsh aayein", "trigram", 0.85),

        ("ask him later", "बाद में उससे पूछें", "baad mein usse poochen", "trigram", 0.88),
        ("call him later", "बाद में उसे कॉल करें", "baad mein use call karein", "trigram", 0.9),
        ("meet him today", "आज उससे मिलें", "aaj usse milen", "trigram", 0.9),
        ("meet her today", "आज उससे मिलें", "aaj usse milen", "trigram", 0.88),
        ("tell him everything", "उसे सब कुछ बताएं", "use sab kuch batayein", "trigram", 0.9),
        ("tell her everything", "उसे सब कुछ बताएं", "use sab kuch batayein", "trigram", 0.9),

        ("i need help", "मुझे मदद चाहिए", "mujhe madad chahiye", "trigram", 0.98),
        ("i need money", "मुझे पैसे चाहिए", "mujhe paise chahiye", "trigram", 0.95),
        ("i need water", "मुझे पानी चाहिए", "mujhe paani chahiye", "trigram", 0.95),
        ("i want food", "मुझे खाना चाहिए", "mujhe khana chahiye", "trigram", 0.95),
        ("i want this", "मुझे यह चाहिए", "mujhe yeh chahiye", "trigram", 0.95),
        ("i like this", "मुझे यह पसंद", "mujhe yeh pasand", "trigram", 0.92),

        ("this is right", "यह सही है", "yeh sahi hai", "trigram", 0.95),
        ("this is wrong", "यह गलत है", "yeh galat hai", "trigram", 0.95),
        ("that is right", "वह सही है", "vah sahi hai", "trigram", 0.9),
        ("that is wrong", "वह गलत है", "vah galat hai", "trigram", 0.9),
        ("this is good", "यह अच्छा है", "yeh accha hai", "trigram", 0.98),
        ("this is bad", "यह बुरा है", "yeh bura hai", "trigram", 0.95),
    ]

        # Convert to dictionary structure and add some programmatic expansions (numbers as digits, ordinal markers)
        lexicon = {}

        for eng, hindi, roman, pos, freq in entries:
            # Normalize key to lowercase where appropriate — but keep keys as original English token forms
            lexicon[eng] = {
                "hindi": hindi,
                "roman": roman,
                "pos": pos,
                "frequency": round(freq, 2)
            }


        # Add some common contractions and social media slang
        slang = {
        "ok": ("ठीक/ओके", "theek/ok", "disc", 0.9),
        "okay": ("ठीक है", "theek hai", "disc", 0.9),
        "lol": ("हँसी", "lol", "disc", 0.6),
        "omg": ("ओह माय गॉड", "oh my god", "disc", 0.6),
        "brb": ("जल्दी आता हूँ", "brb", "disc", 0.4),
        "btw": ("वैसे", "waise", "disc", 0.5),
        "idk": ("मुझे नहीं पता", "mujhe nahi pata", "disc", 0.6),
        "np": ("कोई बात नहीं", "koi baat nahi", "disc", 0.5),
        "pls": ("कृपया", "kripya", "polite", 0.8),

        # ✅ New additions
        "thx": ("धन्यवाद", "thanks", "polite", 0.75),
        "ty": ("धन्यवाद", "thank you", "polite", 0.75),
        "yw": ("आपका स्वागत है", "you are welcome", "polite", 0.6),

        "wtf": ("क्या बकवास", "what the heck", "disc", 0.45),
        "wth": ("क्या हो रहा है", "what the hell", "disc", 0.45),

        "bro": ("भाई", "bhai", "disc", 0.85),
        "sis": ("बहन", "behen", "disc", 0.7),
        "dude": ("दोस्त", "dost", "disc", 0.8),
        "bhai": ("भाई", "bhai", "disc", 0.9),

        "lmao": ("बहुत हँसी", "laughing", "disc", 0.55),
        "lmfao": ("बहुत ज़ोर से हँसी", "laughing hard", "disc", 0.5),

        "afaik": ("जहाँ तक मुझे पता है", "as far as i know", "disc", 0.4),
        "imo": ("मेरे विचार से", "in my opinion", "disc", 0.6),
        "imho": ("नम्रता से मेरे विचार से", "in my humble opinion", "disc", 0.45),
        "tbh": ("सच कहूँ तो", "to be honest", "disc", 0.7),

        "fyi": ("आपकी जानकारी के लिए", "for your info",  "disc", 0.6),
        "ikr": ("मुझे पता है", "i know right", "disc", 0.65),

        "rn": ("अभी", "right now", "disc", 0.6),
        "bcz": ("क्योंकि", "because", "disc", 0.6),
        "cuz": ("क्योंकि", "because", "disc", 0.6),

        "gg": ("अच्छा खेल", "good game", "gaming", 0.65),
        "wp": ("अच्छा खेला", "well played", "gaming", 0.6),
        "afk": ("कीबोर्ड से दूर", "away from keyboard", "gaming", 0.55),
        "op": ("ज़बरदस्त", "over powered", "gaming", 0.75),
        "nerf": ("कमज़ोर करो", "nerf", "gaming", 0.55),
        "buff": ("मज़बूत करो", "buff", "gaming", 0.55),
        "camp": ("छिपकर खेलना", "camp", "gaming", 0.45),

        "rip": ("दुखद", "rest in peace", "disc", 0.6),
        "smh": ("सिर हिलाना", "shaking my head", "disc", 0.45),
        "fr": ("सच में", "for real", "disc", 0.65),
        "sus": ("संदिग्ध", "suspect", "disc", 0.55),
        "cap": ("झूठ", "fake", "disc", 0.55),
        "no cap": ("सच में", "no lie", "disc", 0.55),

        "fab": ("कमाल", "fabulous", "disc", 0.6),
        "lit": ("धांसू", "lit", "disc", 0.65),
        "vibe": ("माहौल", "vibe", "disc", 0.7),
        "swag": ("दबंग स्टाइल", "swag", "disc", 0.6),

        "jk": ("मज़ाक कर रहा हूँ", "just kidding", "disc", 0.7),
        "rofl": ("हँसते-लोटपोट", "rolling laughing", "disc", 0.5),
        "bff": ("सबसे अच्छा दोस्त", "best friend forever", "disc", 0.5),
        "gn": ("शुभ रात्रि", "good night", "disc", 0.8),
        "gm": ("सुप्रभात", "good morning", "disc", 0.8),
        "tc": ("ध्यान रखना", "take care", "disc", 0.8),

        # Hinglish + urban slang
        "jhakkas": ("बेहतरीन", "jhakkas", "slang", 0.7),
        "jhanda": ("फेल", "fail", "slang", 0.6),
        "faltu": ("बेकार", "faltu", "slang", 0.7),
        "timepass": ("समय व्यतीत करना", "timepass", "slang", 0.7),
        "dhansoo": ("धांसू", "dhansu", "slang", 0.7),
        "solid": ("मस्त", "solid", "slang", 0.75),
        "tapori": ("गुंडा-स्टाइल", "tapori", "slang", 0.6),
        "jhool": ("झूठ", "jhooth", "slang", 0.45),
        "killer": ("धांसू", "killer", "slang", 0.65),
        "senti": ("भावुक", "sentimental", "slang", 0.6),
    }

        for k, v in slang.items():
            lexicon[k] = {"hindi": v[0], "roman": v[1], "pos": v[2], "frequency": v[3]}

        # Save lexicon as JSON
        out_path = Path("data/resources/lexicon.json")
        with open(out_path, "w", encoding="utf-8") as f:
            json.dump(lexicon, f, ensure_ascii=False, indent=2)

        return lexicon

    @staticmethod
    def build_discourse_markers():
        """Discourse markers for informal speech"""
        markers = {
            "yaar":      {"position": "end", "formality": 0.1, "frequency": 0.8},
            "na":        {"position": "end", "formality": 0.15, "frequency": 0.7},
            "bhai":      {"position": "anywhere", "formality": 0.2, "frequency": 0.75},
            "re":        {"position": "start", "formality": 0.1, "frequency": 0.6},
            "arre":      {"position": "start", "formality": 0.1, "frequency": 0.65},
            "haan":      {"position": "start", "formality": 0.2, "frequency": 0.7},
            "toh":       {"position": "middle", "formality": 0.25, "frequency": 0.65},
            "accha":     {"position": "start",   "formality": 0.20, "frequency": 0.78},
            "arey":      {"position": "start",   "formality": 0.10, "frequency": 0.72},
            "suno":      {"position": "start",   "formality": 0.25, "frequency": 0.70},
            "sun":       {"position": "start",   "formality": 0.20, "frequency": 0.68},
            "dekho":     {"position": "start",   "formality": 0.20, "frequency": 0.75},
            "dekh":      {"position": "start",   "formality": 0.20, "frequency": 0.70},
            "bilkul":    {"position": "middle",  "formality": 0.30, "frequency": 0.80},
            "pakka":     {"position": "middle",  "formality": 0.30, "frequency": 0.75},
            "mast":      {"position": "middle",  "formality": 0.20, "frequency": 0.65},
            "full":      {"position": "middle",  "formality": 0.25, "frequency": 0.70},
            "ekdum":     {"position": "start",   "formality": 0.20, "frequency": 0.78},
            "seriously": {"position": "start",   "formality": 0.35, "frequency": 0.70},
            "shayad":    {"position": "middle",  "formality": 0.40, "frequency": 0.65},
            "lagta":     {"position": "middle",  "formality": 0.35, "frequency": 0.65},
            "maybe":     {"position": "middle",  "formality": 0.45, "frequency": 0.60},
            "sorta":     {"position": "middle",  "formality": 0.40, "frequency": 0.50},
            "basically": {"position": "start",   "formality": 0.50, "frequency": 0.55},
            "haan na":   {"position": "end",     "formality": 0.15, "frequency": 0.80},
            "right":     {"position": "end",     "formality": 0.40, "frequency": 0.60},
            "haan yaar": {"position": "end",     "formality": 0.15, "frequency": 0.75},
            "well":      {"position": "start",   "formality": 0.55, "frequency": 0.60},
            "so":        {"position": "start",   "formality": 0.50, "frequency": 0.70},
            "waise":     {"position": "start",   "formality": 0.35, "frequency": 0.65},
            "anyway":    {"position": "start",   "formality": 0.55, "frequency": 0.55},
            "bhaiya":    {"position": "anywhere","formality": 0.20, "frequency": 0.70},
            "dost":      {"position": "anywhere","formality": 0.20, "frequency": 0.60},
            "mate":      {"position": "anywhere","formality": 0.30, "frequency": 0.40},
            "bro":       {"position": "anywhere","formality": 0.20, "frequency": 0.75},
            "brother":   {"position": "anywhere","formality": 0.35, "frequency": 0.50},
            "uh":        {"position": "anywhere","formality": 0.40, "frequency": 0.60},
            "uhh":       {"position": "anywhere","formality": 0.35, "frequency": 0.55},
            "hmm":       {"position": "anywhere","formality": 0.30, "frequency": 0.80},
            "umm":       {"position": "anywhere","formality": 0.35, "frequency": 0.65},
            "areh":      {"position": "start",   "formality": 0.15, "frequency": 0.70},
            "par":       {"position": "middle",  "formality": 0.30, "frequency": 0.85},
            "but":       {"position": "middle",  "formality": 0.45, "frequency": 0.85},
            "however":   {"position": "start",   "formality": 0.60, "frequency": 0.50},
            "suno na":   {"position": "start",   "formality": 0.20, "frequency": 0.70},
            "dekho na":  {"position": "start",   "formality": 0.25, "frequency": 0.70},
            "sun na":    {"position": "start",   "formality": 0.20, "frequency": 0.65},
            "theek":        {"position": "start",   "formality": 0.25, "frequency": 0.70},
            "theek hai":    {"position": "end",     "formality": 0.25, "frequency": 0.80},
            "sahi":         {"position": "end",     "formality": 0.20, "frequency": 0.75},
            "sahi hai":     {"position": "end",     "formality": 0.25, "frequency": 0.78},
            "haan bhai":    {"position": "start",   "formality": 0.20, "frequency": 0.70},
            "obviously":    {"position": "start",   "formality": 0.35, "frequency": 0.60},
            "exactly":      {"position": "end",     "formality": 0.40, "frequency": 0.60},
            "shayad na":    {"position": "end",     "formality": 0.40, "frequency": 0.55},
            "lagta na":     {"position": "end",     "formality": 0.40, "frequency": 0.60},
            "aisa lagta":   {"position": "middle",  "formality": 0.35, "frequency": 0.55},
            "mere khayal":  {"position": "start",   "formality": 0.45, "frequency": 0.45},
            "maybe na":     {"position": "end",     "formality": 0.40, "frequency": 0.50},
            "kind of":      {"position": "middle",  "formality": 0.45, "frequency": 0.55},
            "chalo na":     {"position": "start",   "formality": 0.25, "frequency": 0.70},
            "waise na":     {"position": "start",   "formality": 0.30, "frequency": 0.60},
            "acha suno":    {"position": "start",   "formality": 0.25, "frequency": 0.75},
            "sun na bhai":  {"position": "start",   "formality": 0.20, "frequency": 0.65},
            "sun lo":       {"position": "start",   "formality": 0.40, "frequency": 0.60},
            "dekho yaar":   {"position": "start",   "formality": 0.20, "frequency": 0.70},
            "dekho na":     {"position": "start",   "formality": 0.20, "frequency": 0.70},
            "anyways":      {"position": "start",   "formality": 0.55, "frequency": 0.50},
            "seriously yaar": {"position": "end",   "formality": 0.25, "frequency": 0.60},
            "sach me":        {"position": "end",   "formality": 0.25, "frequency": 0.75},
            "sachi":          {"position": "end",   "formality": 0.25, "frequency": 0.70},
            "suna kya":       {"position": "end",   "formality": 0.35, "frequency": 0.50},
            "pata nahi yaar": {"position": "end",   "formality": 0.35, "frequency": 0.65},
            "literally":      {"position": "middle", "formality": 0.50, "frequency": 0.60},
            "seriously na":   {"position": "end",    "formality": 0.35, "frequency": 0.60},
            "totally":        {"position": "middle", "formality": 0.50, "frequency": 0.55},
            "really":         {"position": "middle", "formality": 0.50, "frequency": 0.65},
            "full on":        {"position": "middle", "formality": 0.30, "frequency": 0.55},
            "like":         {"position": "middle",  "formality": 0.50, "frequency": 0.75},
            "bas":          {"position": "middle",  "formality": 0.25, "frequency": 0.80},
            "abey":         {"position": "start",   "formality": 0.10, "frequency": 0.60},
            "abe":          {"position": "start",   "formality": 0.10, "frequency": 0.60},
            "oho":          {"position": "start",   "formality": 0.20, "frequency": 0.55},
            "uff":          {"position": "start",   "formality": 0.20, "frequency": 0.60},
            "samjha":       {"position": "end",     "formality": 0.20, "frequency": 0.65},
            "samjhe":       {"position": "end",     "formality": 0.20, "frequency": 0.55},
            "samjho":       {"position": "end",     "formality": 0.20, "frequency": 0.45},
            "sunraha":      {"position": "middle",  "formality": 0.25, "frequency": 0.40},
            "uff yaar":     {"position": "start",   "formality": 0.10, "frequency": 0.60},
            "oho yaar":     {"position": "start",   "formality": 0.15, "frequency": 0.55},
            "arre yaar":    {"position": "start",   "formality": 0.10, "frequency": 0.70},
            "ya Allah":     {"position": "start",   "formality": 0.15, "frequency": 0.45},
            "hai na":       {"position": "end",     "formality": 0.40, "frequency": 0.70},
            "matlab":     {"position": "middle",  "formality": 0.40, "frequency": 0.85},
            "matlab na":  {"position": "end",     "formality": 0.40, "frequency": 0.75},
            "mera matlab": {"position": "start",  "formality": 0.50, "frequency": 0.60},
            "ek second":  {"position": "start",   "formality": 0.35, "frequency": 0.65},
            "chalo theek":     {"position": "start",   "formality": 0.25, "frequency": 0.60},
            "haan theek":      {"position": "start",   "formality": 0.30, "frequency": 0.60},
            "haan sahi":       {"position": "start",   "formality": 0.30, "frequency": 0.50},
            "haan okay":       {"position": "start",   "formality": 0.35, "frequency": 0.45},
            "ok boss":         {"position": "end",     "formality": 0.15, "frequency": 0.30},
        }

        with open('data/resources/markers.json', 'w', encoding='utf-8') as f:
            json.dump(markers, f, ensure_ascii=False, indent=2)
        return markers

    @staticmethod
    def build_all():
        """Build all resources"""
        lexicon = LinguisticResourceBuilder.build_lexicon()
        markers = LinguisticResourceBuilder.build_discourse_markers()
        print(f"✓ Lexicon: {len(lexicon)} entries")
        print(f"✓ Markers: {len(markers)} entries")
        return lexicon, markers

# Build resources
LEXICON, MARKERS = LinguisticResourceBuilder.build_all()

# ============================================================================
# 3. CONTROL SCHEMA
# ============================================================================

@dataclass
class ControlConfig:
    """Control parameters for code-mixing"""
    target_language: str = "Hindi"
    cmi_target: float = 0.8  # 0-1, percentage of target language
    formality: float = 0.2   # 0-1, 0=very informal, 1=very formal
    domain: str = "casual_chat"

    def to_instruction(self) -> str:
        """Convert to natural language instruction"""
        cmi_label = "high" if self.cmi_target > 0.6 else "medium" if self.cmi_target > 0.3 else "low"
        formality_label = "formal" if self.formality > 0.6 else "informal"

        return f"""Generate code-mixed {self.target_language}-English text with:
- Code-mixing density: {cmi_label} ({self.cmi_target:.1%})
- Style: {formality_label}
- Domain: {self.domain}"""

# ============================================================================
# 4. STATE-OF-THE-ART HYBRID GENERATOR
# ============================================================================

print("\n⏳ Loading advanced NLP models for state-of-the-art generation...")

import spacy
from transformers import AutoTokenizer, AutoModelForSeq2SeqLM, pipeline
import nltk

# Download NLTK data
try:
    nltk.data.find('corpora/wordnet')
except LookupError:
    nltk.download('wordnet', quiet=True)
    nltk.download('averaged_perceptron_tagger', quiet=True)
    nltk.download('punkt', quiet=True)

from nltk.corpus import wordnet
from nltk.stem import WordNetLemmatizer

class StateOfTheArtCodeMixGenerator:
    """
    Advanced code-mixing generator using:
    - Spacy for linguistic analysis
    - Neural Machine Translation for phrase-level mixing
    - Constraint-based generation for grammatical correctness
    - Pragmatic rules for discourse markers
    - Multi-strategy candidate ranking
    """

    def __init__(self, use_nmt: bool = True):
        self.nlp = spacy.load('en_core_web_sm')
        self.lexicon = LEXICON
        self.markers = MARKERS
        self.lemmatizer = WordNetLemmatizer()

        # Load NMT model for high-quality phrase translation
        self.use_nmt = use_nmt
        if use_nmt:
            self.nmt_tokenizer = AutoTokenizer.from_pretrained("Helsinki-NLP/opus-mt-en-hi")
            self.nmt_model = AutoModelForSeq2SeqLM.from_pretrained("Helsinki-NLP/opus-mt-en-hi")

        # Matrix language detection (base structure language)
        self.matrix_language_patterns = {
            "English": ["VB.*", "MD", "TO"],  # English verbs, modals, infinitives
            "Hindi": ["NN.*", "JJ.*"]  # Nouns and adjectives can be mixed
        }

    def get_wordnet_pos(self, spacy_pos: str) -> str:
        """Convert spacy POS to WordNet POS for better lemmatization"""
        pos_map = {
            'NOUN': wordnet.NOUN,
            'VERB': wordnet.VERB,
            'ADJ': wordnet.ADJ,
            'ADV': wordnet.ADV
        }
        return pos_map.get(spacy_pos, wordnet.NOUN)

    def advanced_lemmatize(self, token) -> str:
        """Use WordNet for accurate lemmatization"""
        wordnet_pos = self.get_wordnet_pos(token.pos_)
        lemma = self.lemmatizer.lemmatize(token.text.lower(), pos=wordnet_pos)
        return lemma

    def identify_code_switch_points(self, doc, control: ControlConfig) -> set:
        """
        Identify linguistically valid code-switching points based on:
        - Equivalence Constraint: No switching between bound morphemes
        - Free Morpheme Constraint: Only switch at free morpheme boundaries
        - Matrix Language Frame: Preserve base language grammar
        """
        switch_points = set()

        for i, token in enumerate(doc):
            # Rule 1: Never switch within compounds or contractions
            if token.text in ["n't", "'s", "'re", "'ve", "'ll"]:
                continue

            # Rule 2: Prefer switching at noun phrases (most common in code-mixing)
            if token.pos_ in ['NOUN', 'PROPN'] and np.random.random() < control.cmi_target * 1.2:
                switch_points.add(i)

            # Rule 3: Switch adjectives modifying nouns
            if token.pos_ == 'ADJ' and token.head.pos_ in ['NOUN', 'PROPN']:
                if np.random.random() < control.cmi_target * 0.8:
                    switch_points.add(i)

            # Rule 4: Switch verbs in main clauses (not auxiliaries)
            if token.pos_ == 'VERB' and token.dep_ not in ['aux', 'auxpass']:
                if np.random.random() < control.cmi_target * 0.7:
                    switch_points.add(i)

            # Rule 5: Question words often switch
            if token.pos_ == 'ADV' and token.dep_ == 'advmod' and token.text.lower() in ['how', 'what', 'when', 'where']:
                if np.random.random() < control.cmi_target * 0.9:
                    switch_points.add(i)

        return switch_points

    def apply_matrix_language_constraints(self, doc, switch_points: set, control: ControlConfig) -> set:
        """
        Apply Matrix Language Frame model:
        - System morphemes (function words) come from matrix language
        - Content morphemes can come from embedded language
        """
        filtered_points = set()

        for idx in switch_points:
            token = doc[idx]

            # Keep content words (can switch)
            if token.pos_ in ['NOUN', 'VERB', 'ADJ', 'ADV', 'PROPN']:
                filtered_points.add(idx)

            # Optionally allow function words for high density
            elif control.cmi_target > 0.6 and token.pos_ in ['PRON', 'DET']:
                if np.random.random() < 0.3:  # Limited switching
                    filtered_points.add(idx)

        return filtered_points

    def translate_with_nmt(self, phrase: str) -> str:
        """Use neural translation for phrases not in lexicon"""
        if not self.use_nmt:
            return None

        try:
            inputs = self.nmt_tokenizer(phrase, return_tensors="pt", padding=True)
            translated = self.nmt_model.generate(**inputs, max_length=50)
            result = self.nmt_tokenizer.decode(translated[0], skip_special_tokens=True)

            # Romanize the output (basic Devanagari to Roman)
            result = self.romanize_hindi(result)
            return result
        except Exception as e:
            return None

    def romanize_hindi(self, text: str) -> str:
        """Convert Devanagari script to Roman (basic mapping)"""
        devanagari_to_roman = {
            'क': 'ka', 'ख': 'kha', 'ग': 'ga', 'घ': 'gha', 'ङ': 'nga',
            'च': 'cha', 'छ': 'chha', 'ज': 'ja', 'झ': 'jha', 'ञ': 'nya',
            'ट': 'ta', 'ठ': 'tha', 'ड': 'da', 'ढ': 'dha', 'ण': 'na',
            'त': 'ta', 'थ': 'tha', 'द': 'da', 'ध': 'dha', 'न': 'na',
            'प': 'pa', 'फ': 'pha', 'ब': 'ba', 'भ': 'bha', 'म': 'ma',
            'य': 'ya', 'र': 'ra', 'ल': 'la', 'व': 'va',
            'श': 'sha', 'ष': 'sha', 'स': 'sa', 'ह': 'ha',
            'ा': 'a', 'ि': 'i', 'ी': 'i', 'ु': 'u', 'ू': 'u',
            'े': 'e', 'ै': 'ai', 'ो': 'o', 'ौ': 'au', '्': '',
            'ं': 'n', 'ः': 'h', 'ँ': 'n',
        }

        romanized = []
        for char in text:
            if char in devanagari_to_roman:
                romanized.append(devanagari_to_roman[char])
            elif char.isascii():
                romanized.append(char)
            else:
                romanized.append(char)

        return ''.join(romanized)

    def get_mixed_word_candidates(self, token, lemma: str) :
        """
        Generate multiple candidates for code-mixing a word with confidence scores
        Returns: [(candidate_word, confidence_score), ...]
        """
        candidates = []

        # Strategy 1: Lexicon lookup (highest confidence)
        if lemma in self.lexicon:
            roman_word = self.lexicon[lemma]['roman']
            frequency = self.lexicon[lemma]['frequency']
            candidates.append((roman_word, frequency))

        # Strategy 2: POS-based fallback from lexicon
        if token.pos_ in ['NOUN', 'VERB', 'ADJ']:
            for lex_lemma, lex_data in self.lexicon.items():
                if lex_data['pos'] == token.pos_.lower() and not candidates:
                    candidates.append((lex_data['roman'], 0.5))
                    break

        # Strategy 3: Neural translation (medium confidence)
        if self.use_nmt and not candidates:
            nmt_result = self.translate_with_nmt(token.text)
            if nmt_result and nmt_result.strip():
                candidates.append((nmt_result, 0.6))

        # Strategy 4: Keep original if no candidates
        if not candidates:
            candidates.append((token.text, 0.3))

        return candidates

    def rank_and_select_candidate(self, candidates,
                                  control: ControlConfig) :
        """Select best candidate based on control parameters and confidence"""
        if not candidates:
            return ""

        # Weight by confidence and formality
        scored_candidates = []
        for word, confidence in candidates:
            score = confidence
            if control.formality < 0.3:
                if word in ['yaar', 'bhai', 'na', 'kya', 'kaise']:
                    score *= 1.2

            scored_candidates.append((word, score))

        # Select highest scoring
        best_candidate = max(scored_candidates, key=lambda x: x[1])
        return best_candidate[0]

    def inject_discourse_markers_advanced(self, text: str, doc, control: ControlConfig) -> str:
        """
        Advanced discourse marker injection based on:
        - Sentence position
        - Speech act type
        - Formality level
        - Pragmatic context
        """
        if control.formality > 0.5:
            return text

        tokens = text.split()
        marker_injected = False

        # Analyze sentence type
        is_question = doc[-1].text == '?' or doc[0].pos_ in ['ADV'] and doc[0].text.lower() in ['what', 'how', 'when']
        is_imperative = doc[0].pos_ == 'VERB' and doc[0].tag_ == 'VB'

        # Strategy 1: Tag questions for yes/no contexts
        if is_question and not marker_injected and control.formality < 0.3:
            if np.random.random() < 0.6:
                text = text.rstrip('?') + " na?"
                marker_injected = True

        # Strategy 2: Start-of-utterance markers for exclamations
        if not marker_injected and control.formality < 0.25:
            if np.random.random() < 0.4:
                starters = ['arre', 're', 'haan']
                text = np.random.choice(starters) + " " + text
                marker_injected = True

        # Strategy 3: End-of-utterance vocatives for casual address
        if not marker_injected and control.formality < 0.35:
            if control.domain == "casual_chat" and np.random.random() < 0.5:
                vocatives = ['yaar', 'bhai', 'boss']
                text = text + " " + np.random.choice(vocatives)
                marker_injected = True

        # Strategy 4: Connectives for complex sentences
        if len(doc) > 8 and not marker_injected:
            for i, token in enumerate(doc):
                if token.dep_ == 'mark' or token.pos_ == 'SCONJ':
                    if np.random.random() < 0.3:
                        words = text.split()
                        if i < len(words):
                            words.insert(i, 'toh')
                            text = ' '.join(words)
                            break

        return text

    def apply_phonetic_spelling_variation(self, text: str, control: ControlConfig) -> str:
        """
        Apply realistic phonetic spelling variations common in Hinglish social media.

        Enhancements:
        - Adds richer phonetic variation clusters
        - Optional vowel-dropping or nasal-dropping
        - Reduced/elongated spellings (haaaai, kyuuuun)
        - Reduplication patterns: "bahut bahut", "mast mast"
        - Weighted sampling

        If control.formality > 0.5 → minimal modification
        """
        import numpy as np
        import random

        if control.formality > 0.5:
            return text

        variations = {
            # Core non-English phonetic variation
            'kya':     ['kya', 'kia', 'kyaaa', 'kyu'],
            'kaise':   ['kaise', 'kese', 'kayse'],
            'kidhar':  ['kidhar', 'kidhr', 'kidar'],
            'kyun':    ['kyun', 'kyu', 'kyo'],
            'hain':    ['hain', 'hen', 'h', 'hai'],
            'hai':     ['hai', 'h', 'he'],
            'hoon':    ['hoon', 'hun', 'hu'],
            'hun':     ['hun', 'hu', 'hoon'],
            'main':    ['main', 'mein', 'me', 'mn'],
            'bhi':     ['bhi', 'bhii', 'bhi'],
            'nahi':    ['nahi', 'nhi', 'nai'],
            'acha':    ['acha', 'accha', 'achha', 'acha'],
            'haan':    ['haan', 'ha', 'han', 'haan'],
            'chal':    ['chal', 'chl', 'chalo'],
            'bahut':   ['bahut', 'bohot', 'bohut', 'bahot'],
            'matlab':  ['matlab', 'mtlb', 'mtlb', 'mtl'],
            'samajh':  ['samajh', 'samjh', 'smjh', 'smj'],
            'dekh':    ['dekh', 'dekhh', 'dekhh', 'dekhna'],
            'abhi':    ['abhi', 'abhi', 'abi'],
            'kabhi':   ['kabhi', 'kbhi', 'kbhii'],
            'kahan':   ['kahan', 'kha', 'khn'],
            'log':     ['log', 'logg', 'lg'],

            # Emphasis elongations
            'mast':    ['mast', 'massst'],
            'nice':    ['nice', 'nyc'],
            'very':    ['very', 'vry'],
            'please':  ['please', 'plz', 'pls'],

            # English side variation
            'going':   ['going', 'goin', 'gn'],
            'coming':  ['coming', 'comin'],
            'bro':     ['bro', 'broski', 'bru'],
        }

        # Optional reduplication clusters
        reduplication_candidates = {
            'bahut': 0.20,
            'mast':  0.15,
            'accha': 0.15,
            'nice':  0.10,
        }

        words = text.split()
        out = []

        for w in words:
            lw = w.lower()

            # 1) phonetic substitution
            if lw in variations and random.random() < 0.25:
                cand = variations[lw]
                w = random.choice(cand)

            # 2) reduplication occasional
            if lw in reduplication_candidates:
                if random.random() < reduplication_candidates[lw]:
                    w = f"{w} {w}"

            # 3) occasional vowel stretching for emphasis
            if random.random() < 0.05 and len(w) > 2:
                # stretch last vowel
                for v in "aeiou":
                    if w.endswith(v):
                        w = w + v * random.randint(1, 3)
                        break

            out.append(w)

        return " ".join(out)

    def generate(self, text: str, control: ControlConfig) -> str:
        """
        State-of-the-art code-mixed text generation pipeline
        """
        if not text or not text.strip():
            return text

        # Step 1: Linguistic analysis
        doc = self.nlp(text)

        # Step 2: Identify valid code-switching points
        switch_points = self.identify_code_switch_points(doc, control)
        switch_points = self.apply_matrix_language_constraints(doc, switch_points, control)

        # Step 3: Generate mixed tokens
        output_tokens = []
        for i, token in enumerate(doc):
            if i in switch_points:
                lemma = self.advanced_lemmatize(token)
                candidates = self.get_mixed_word_candidates(token, lemma)
                mixed_word = self.rank_and_select_candidate(candidates, control)
                output_tokens.append(mixed_word)
            else:
                output_tokens.append(token.text)

        # Step 4: Reconstruct sentence with proper spacing
        result = ' '.join(output_tokens)

        # Step 5: Apply discourse markers with pragmatic rules
        result = self.inject_discourse_markers_advanced(result, doc, control)

        # Step 6: Apply phonetic variations for authenticity
        result = self.apply_phonetic_spelling_variation(result, control)

        # Step 7: Clean up spacing and punctuation
        result = result.replace(' ,', ',').replace(' .', '.').replace(' ?', '?')
        result = result.replace('  ', ' ').strip()

        return result

# Initialize state-of-the-art generator
print("\n" + "="*60)
print("INITIALIZING STATE-OF-THE-ART GENERATOR")
print("="*60)

try:
    generator = StateOfTheArtCodeMixGenerator(use_nmt=True)
    print("\n✓ Advanced generator ready with NMT support")
except Exception as e:
    print(f"\n⚠ NMT loading failed: {e}")
    print("Falling back to lexicon-only mode...")
    generator = StateOfTheArtCodeMixGenerator(use_nmt=False)
    print("✓ Generator ready (lexicon-only mode)")

# Test the advanced generator
print("\n" + "-"*60)
print("TESTING ADVANCED GENERATOR")
print("-"*60)

test_cases = [
    ("I am going to the market to buy vegetables", ControlConfig(cmi_target=0.7, formality=0.2)),
    ("How are you doing today?", ControlConfig(cmi_target=0.8, formality=0.1)),
    ("Can you help me with this problem?", ControlConfig(cmi_target=0.8, formality=0.3)),
]

for text, control in test_cases:
    output = generator.generate(text, control)
    print(f"\nInput:  {text}")
    print(f"Control: CMI={control.cmi_target}, Formality={control.formality}")
    print(f"Output: {output}")

# ============================================================================
# 5. DATASET GENERATION
# ============================================================================

import json
import os
import re
import hashlib
import numpy as np
from dataclasses import asdict
from typing import List, Dict
from tqdm import tqdm
from collections import Counter
import random

# ----------------------------------------------------------------------
# Helpers
# ----------------------------------------------------------------------

PROFANITY_RE = re.compile(r"(fuck|shit|asshole|bitch)", re.IGNORECASE)

def _normalize_space(s: str) -> str:
    return re.sub(r"\s+", " ", s).strip()

def _hash_text(s: str) -> str:
    return hashlib.md5(s.encode("utf-8")).hexdigest()


# ----------------------------------------------------------------------
# Dataset Builder
# ----------------------------------------------------------------------

class DatasetBuilder:
    """Build instruction dataset with diverse domains and controls"""

    def __init__(self, generator, curated_file: str = None, seed: int = 42):
        self.generator = generator
        self.dataset = []
        self.curated_file = curated_file
        self.seen = set()                 # track duplicates
        self.stats = Counter()
        random.seed(seed)
        np.random.seed(seed)

    # ---------------------------------------------------------------
    # BASE ENGLISH EXAMPLES (unchanged but normalized)
    # ---------------------------------------------------------------
    def get_base_examples(self) -> List[Dict]:
        """Generate base English examples from various domains"""

        # (unchanged lists)
        casual_chat = [
        "Hey, how are you doing right now?",
        "I was thinking we could meet later today.",
        "I am feeling tired after a very long day.",
        "Let’s talk when you are a little free.",
        "I will call you again after some time.",
        "I am just sitting here doing absolutely nothing.",
        "Where are you currently? I have been waiting.",
        "I reached home safely, please don't worry.",
        "I will text you once I get ready.",
        "Can you stay online for a few minutes?",
        "I am outside your place, please come down.",
        "I might be late today because of traffic.",
        "I feel like going out for some snacks.",
        "I really enjoyed our conversation the other day.",
        "I am feeling better now after some rest.",
        "I will join you whenever you want me.",
        "I forgot what I wanted to tell you.",
        "I will be free after finishing some work.",
        "Tell me when you want to meet again.",
        "I woke up early and still feel sleepy.",
        "I think we should catch up this weekend.",
        "I found something interesting and want to share.",
        "I will bring something for you on my way.",
        "Can you send me your location right now?",
        "I will talk to you when I reach home.",
        "I feel very happy today for no reason.",
        "I want to rest for a few minutes first.",
        "I think you should take some proper rest.",
        "I am walking outside just to get fresh air.",
        "I will go out only if you come.",
        "I am feeling a little stressed right now.",
        "I think I misplaced my keys somewhere today.",
        "I forgot to charge my phone last night.",
        "I will be ready in about ten minutes.",
        "I am getting hungry, let's eat something soon.",
        "I want to show you something very funny.",
        "I am really missing our late night talks.",
        "I need to spend more time with you.",
        "I saw something today that reminded me of you.",
        "I was laughing so much earlier today.",
        "I like this peaceful weather very much today.",
        "I want to go for a long drive.",
        "Let’s sit somewhere quiet and talk peacefully.",
        "I think we should try a different place.",
        "I want a break from everything right now.",
        "I will tell you everything when we meet.",
        "I am just relaxing and listening to music.",
        "I forgot where I kept my wallet yesterday.",
        "I am almost there, please just wait once.",
        "I will step out as soon as I finish.",
        "I am going downstairs, meet me near the gate.",
        "I found the book you recommended last month.",
        "Let me know when you reach your home.",
        "I feel better after talking to you.",
        "I think I should sleep a little earlier.",
        "I woke up late because I slept late.",
        "I am coming back soon, please wait there.",
        "I feel like going somewhere this evening.",
        "I have nothing important to do right now.",
        "I am planning to leave in ten minutes.",
        "Can we meet tomorrow if you are free?",
        "I will text you when I am leaving.",
        "I will finish this work and join soon.",
        "I am getting bored sitting here alone.",
        "Can you stay with me for some time?",
        "I liked spending time with you last night.",
        "I am going to rest for a while.",
        "I feel like watching a movie tonight.",
        "I am standing outside your building right now.",
        "I might take a short nap before leaving.",
        "I really need some fresh air right now.",
        "I want to order food but can't decide.",
        "Let’s meet somewhere quiet and just talk.",
        "I really enjoyed today, thank you so much.",
        "I will leave soon, I am almost ready.",
        "I want to go for a small walk.",
        "Let’s just chill and relax for now.",
        "I will stay here until you come back.",
        "I was thinking of taking a short break.",
        "I feel like going to the mall today.",
        "I am getting late, please wait for me.",
        "I forgot to tell you something important today.",
        "I found an old picture of us today.",
        "Let’s do something fun together this weekend.",
        "I might come early if I finish soon.",
        "I had a long day and need rest.",
        "I will check and let you know later.",
        "I am thinking of trying a new cafe.",
        "I want to sit in silence right now.",
        "I feel relaxed after a hot cup of tea.",
        "I am coming soon, just finishing my work.",
        "I will be outside waiting for you soon.",
        "I am doing nothing special, just chilling here.",
        "I had a nice time talking to you.",
        "I feel like listening to soft music tonight.",
        "I am on call, I will text later.",
        "Let’s plan something interesting for this weekend.",
        "I am packing my things to leave now.",
        "I think we should meet more often."
        ]
        daily_routines = [
        "I wake up early every single morning.",
        "I brush my teeth before having breakfast.",
        "I take a quick shower after waking up.",
        "I drink warm water every morning before work.",
        "I prepare breakfast and eat with my family.",
        "I leave home early to avoid heavy traffic.",
        "I check my phone notifications while drinking tea.",
        "I read the news every morning before starting work.",
        "I water the plants before leaving for office.",
        "I take public transport when going to the office.",
        "I start working as soon as I reach office.",
        "I attend morning meetings before starting my regular tasks.",
        "I go for a short walk during lunch break.",
        "I eat lunch with my colleagues in the cafeteria.",
        "I reply to emails before finishing my daily tasks.",
        "I make a to-do list for the next day.",
        "I leave office early when I finish my work.",
        "I listen to music while traveling back home.",
        "I pick up groceries on my way back home.",
        "I clean my shoes after returning from work.",
        "I help my family prepare dinner at night.",
        "I enjoy tea or coffee in the evening.",
        "I talk about my day with my family.",
        "I wash dishes after finishing my dinner.",
        "I fold clothes after doing laundry on weekends.",
        "I organize my room whenever I get free time.",
        "I read a book before going to sleep.",
        "I write in my journal before sleeping at night.",
        "I turn off my phone before going to bed.",
        "I set an alarm before sleeping every night.",
        "I exercise regularly to maintain a healthy lifestyle.",
        "I stretch for a few minutes every morning.",
        "I meditate daily to improve my focus.",
        "I clean my glasses before leaving the house.",
        "I arrange my bag before going to work.",
        "I feed my pet every morning before breakfast.",
        "I wash vegetables before cooking at night.",
        "I change into comfortable clothes after getting home.",
        "I call my parents every evening after dinner.",
        "I check my calendar to plan my activities.",
        "I keep my surroundings clean throughout the week.",
        "I wipe the floor of my room twice weekly.",
        "I put leftovers in the fridge after dinner.",
        "I pack my lunch before going to sleep.",
        "I iron my clothes for the next day.",
        "I wash my hands before eating every meal.",
        "I check work messages in the morning daily.",
        "I refill my water bottle before leaving home.",
        "I keep my wallet and keys near the door.",
        "I plan weekend activities with my family regularly.",
        "I keep track of expenses every evening before bed.",
        "I take vitamins in the morning with water.",
        "I mop the floor every alternate day at home.",
        "I clean my desk every week to organize things.",
        "I schedule appointments early to manage my time.",
        "I practice breathing exercises every morning for energy.",
        "I prepare fresh juice for breakfast on Sundays.",
        "I check grocery supplies before going to the market.",
        "I separate dry and wet waste every morning.",
        "I clean my kitchen counter after every meal.",
        "I wash fruits before storing them in the refrigerator.",
        "I dust my furniture once every three days.",
        "I make a weekly plan every Sunday morning.",
        "I list tasks to complete before leaving work.",
        "I arrange documents neatly on my office desk.",
        "I exercise lightly at home before taking a shower.",
        "I fold fresh clothes and arrange them in drawers.",
        "I drink milk at night before sleeping peacefully.",
        "I learn something new every day for growth.",
        "I practice writing and reading daily to improve skills.",
        "I water indoor plants every second day for freshness.",
        "I go grocery shopping twice a week after work.",
        "I keep my workspace clean every single day.",
        "I talk to my neighbors while walking in the area.",
        "I help children with studies after returning home.",
        "I make soup whenever I feel unwell at night.",
        "I wash my face whenever I feel tired.",
        "I place used clothes in the laundry basket daily.",
        "I organize my shelves every month for cleanliness.",
        "I send important messages before starting morning tasks.",
        "I update my planner to track my progress.",
        "I enjoy evening walks to clear my mind.",
        "I clean my phone screen once every day.",
        "I refill the water filter before going to sleep.",
        "I review my notes every night before bed.",
        "I drink lemon water every morning for energy.",
        "I polish shoes every weekend to maintain them.",
        "I clean my bathroom regularly to maintain hygiene.",
        "I practice speaking exercises to improve communication skills.",
        "I prepare snacks for work every evening before bed.",
        "I fold bedsheets neatly every morning after waking.",
        "I clean my car every weekend with my family.",
        "I keep my phone on silent during sleep hours.",
        "I maintain notebooks for daily work and study.",
        "I send morning greetings to family and friends.",
        "I unplug chargers when not using the devices.",
        "I check weather forecast before leaving my house.",
        "I remember to stretch while working long hours.",
        "I cook simple meals when I feel very tired.",
        "I drink herbal tea before going to sleep."
    ]

        logistics_travel = [
        "Where is the nearest bus stop from here?",
        "How long will it take to reach downtown?",
        "I need a taxi to the airport now.",
        "Please drop me near the main entrance.",
        "Can you tell me the correct platform number?",
        "When does the next train arrive at this station?",
        "I am booking a cab for early morning travel.",
        "Is there a direct bus route to the station?",
        "I must reach the airport at least two hours early.",
        "Can you guide me to the nearest metro station?",
        "I want to check the timetable for the next train.",
        "How far is the hotel from the railway station?",
        "I need to confirm the departure time again.",
        "Is there a place to keep my luggage safely?",
        "I will pick up the tickets this evening.",
        "Can you help me find a cheaper route?",
        "I want to travel tomorrow but need suggestions.",
        "How long does it take to reach the airport?",
        "I want to sit near the window seat.",
        "Please let me know when my stop arrives.",
        "I will book my ticket online this evening.",
        "Is there any direct flight available tonight?",
        "I want to change my seat if possible.",
        "My cab will arrive in five more minutes.",
        "The driver asked me for exact directions.",
        "We should leave early to avoid traffic jams.",
        "Please share your live location for easy pickup.",
        "There is heavy traffic on this main road.",
        "We need to take the next right turn.",
        "Can you drive faster? We are getting late.",
        "I need a break; let's stop somewhere soon.",
        "Please keep the bags safely in the trunk.",
        "I want a cab with extra luggage space.",
        "The train got delayed due to weather issues.",
        "Where can I find an affordable guest house?",
        "Please remind me when we reach the station.",
        "I think we should take the shorter route.",
        "There is a coffee shop near the airport parking.",
        "Can you check if the bus has already left?",
        "I forgot to carry my travel documents today.",
        "I want to check in my luggage early.",
        "Please wait here while I confirm the tickets.",
        "I would like to travel in the evening.",
        "Is this the quickest route to the airport?",
        "Can we get a map of this area?",
        "I need help finding the rental car counter.",
        "I want to upgrade my seat for more comfort.",
        "The ticket price increased since last week.",
        "I want to carry only hand luggage today.",
        "Please tell me where the exit gate is.",
        "We need to reach the terminal within fifteen minutes.",
        "I need to refill the fuel before leaving.",
        "Can you check if the toll has been paid?",
        "The bus will stop here for five minutes.",
        "Please bring my luggage to the front door.",
        "I have already shared my live location link.",
        "I need to catch the train at ten sharp.",
        "Where can I buy a metro smart card?",
        "The car is waiting for us outside right now.",
        "I forgot my wallet inside the taxi earlier.",
        "Please slow down; I am feeling uncomfortable.",
        "I think we missed the correct turn earlier.",
        "We need to find a petrol pump nearby.",
        "Can you ask someone for proper directions?",
        "The flight got canceled due to technical issues.",
        "I want to travel light on this trip.",
        "Let’s stop here to stretch our legs properly.",
        "I want to sit near the aisle side.",
        "My hotel is only five minutes from here.",
        "We can take a shortcut through the market.",
        "I want to buy snacks for the journey.",
        "Please check the luggage before we move ahead.",
        "The driver is asking for extra cash today.",
        "I left my charger in the previous hotel.",
        "I want to travel by train this time.",
        "Can you please help me carry this bag?",
        "The road ahead is blocked due to maintenance.",
        "We should refuel before continuing the journey.",
        "I hope we reach the destination on time.",
        "Please keep the documents ready for verification.",
        "The bus is extremely crowded during peak hours.",
        "I want to confirm my boarding gate number.",
        "Please check if the restroom is nearby.",
        "This road looks unsafe during night time travel.",
        "Our train stops only for two minutes here.",
        "Let’s take a cab instead of the metro.",
        "We should arrive earlier to avoid any problems.",
        "I want to stay near the city center.",
        "Can we leave in the morning tomorrow?",
        "I am waiting for you near the main gate.",
        "I found a better route using online navigation.",
        "Please carry a bottle of water for travel.",
        "The bus conductor asked us to move forward.",
        "I want a comfortable seat for this long journey.",
        "My suitcase is very heavy; please help me.",
        "Let’s take a short break for refreshments.",
        "I want to explore nearby places after checking in.",
        "Please take the car to the parking lot.",
        "I forgot to print my boarding pass today.",
        "Let’s wait here until the bus arrives.",
        "I need to cancel my ticket for tomorrow.",
        "I will book a return ticket next week.",
        "I need to confirm my hotel reservation details."
    ]
        commerce_shopping = [
        "How much does this product cost right now?",
        "Is there any discount available on this item?",
        "Can I return this product if damaged later?",
        "Do you accept card payments for this purchase?",
        "Is this available in different color options?",
        "Can you deliver this item by tomorrow?",
        "Please show me similar products within this price range.",
        "Is there any ongoing offer on electronics today?",
        "I want to compare the price on other sites.",
        "Can you pack this item as a gift?",
        "Does this product come with a standard warranty?",
        "Is there an exchange offer available for old devices?",
        "Can you check if a new stock is available?",
        "I would like to buy the same item again.",
        "Can you suggest something cheaper with similar quality?",
        "Do you have a trial room available here?",
        "I want to check the quality before purchasing anything.",
        "Can I get a refund if I don't like it?",
        "Is there a replacement policy for defective pieces?",
        "Can you tell me when this item will be restocked?",
        "I need help finding the right shoe size.",
        "Is this product available in a smaller size?",
        "Can you provide a detailed bill for this purchase?",
        "Do you sell accessories for this model here?",
        "I need to check if the material is washable.",
        "Is home delivery free for this particular item?",
        "Can I use digital payment applications here?",
        "Please let me know if there's a membership discount.",
        "Can you help me choose between these two items?",
        "I want to return this because it doesn't fit.",
        "Do you have more options available in this design?",
        "Can you show me something in a brighter color?",
        "Is there an extended warranty available for this device?",
        "Can I get this delivered to my office address?",
        "I need some help understanding these specifications.",
        "Is this genuine or a third-party product?",
        "Can you please pack this item carefully?",
        "How long will it take to deliver this?",
        "I would like to pay in monthly installments.",
        "Do you accept international credit cards here?",
        "Can you help apply my coupon code?",
        "I want to check the reviews before buying this.",
        "Do you provide after-sales service for this category?",
        "Please let me know if there’s a festive discount.",
        "Can you show me the latest arrivals in this brand?",
        "Is this product available in more size variations?",
        "I want something similar but slightly bigger.",
        "Does this price include all taxes already?",
        "I only need the basic version of this.",
        "Can you show me the premium version also?",
        "I want to buy this but need a lower price.",
        "Do you have special deals for bulk purchases?",
        "Can I reserve this product for pickup later?",
        "Is there a cancellation fee for preorder items?",
        "Can you send an invoice to my email address?",
        "I want to know if this material shrinks after washing.",
        "Is this product suitable for daily usage?",
        "Can you gift-wrap this without extra charges?",
        "Can I pay half now and half later?",
        "Do you have seasonal offers running this month?",
        "Is this available in the newest collection?",
        "Can I try this on before buying?",
        "Does this come with installation support included?",
        "Can you recommend a good alternative to this?",
        "How much discount can I get using my card?",
        "Can I check the product before paying?",
        "I want to check if this brand is durable.",
        "Does this model have better battery backup?",
        "Is there a combo offer available right now?",
        "Can I get cashback on this purchase?",
        "Is there any loyalty program I can join?",
        "Can I buy this now and pick up later?",
        "Please tell me which product is most popular.",
        "Do you have a return counter nearby?",
        "I would like to compare this with another model.",
        "Is this product water resistant or waterproof?",
        "Can you please check stock in another branch?",
        "Does this price include the installation charges?",
        "Is the return window still valid for this?",
        "Can you help me carry this to my car?",
        "How long is the warranty on this blender?",
        "Is this available in stainless steel finish?",
        "Do you have a better price for regular customers?",
        "Can you notify me when this product arrives?",
        "Does this store provide free home assembly?",
        "Can you help me redeem my store points?",
        "Is this product safe for children to use?",
        "Can you explain the difference between these models?",
        "Does this fabric require dry cleaning every time?",
        "Is there a student discount available for this?",
        "Can I exchange this for a smaller size later?",
        "I need a lighter version of this product.",
        "Do you have a no-questions return policy?",
        "Can I get the older version at a cheaper price?",
        "I need a model with better battery life.",
        "Can you suggest a product with longer durability?",
        "Are there hidden charges apart from this price?",
        "Can you print a duplicate bill for me?",
        "Does this include accessories inside the box?",
        "Can I prebook this if stock is limited?",
        "I want to know if this color fades quickly.",
        "Do you offer free demo service at home?",
        "Can I buy this online for better benefits?",
        "Is this product environmentally friendly and reusable?"
    ]

        customer_support = [
        "I am unable to log into my account today.",
        "My payment was deducted but order still shows pending.",
        "I forgot my password and need immediate help.",
        "I am not receiving the verification email anymore.",
        "My device is not working after the latest update.",
        "I need assistance resetting my account credentials.",
        "My order has been delayed without any proper update.",
        "I need a replacement because the product arrived broken.",
        "I am unable to update my profile information online.",
        "The service representative did not respond to my request.",
        "I want to know the status of my refund.",
        "The app keeps crashing whenever I try opening it.",
        "I cannot complete the payment due to an unknown error.",
        "My ticket number is still not resolved yet.",
        "I want to know if my order has shipped.",
        "I need technical support to fix this problem.",
        "I cannot connect to the server right now.",
        "The product I received looks different than advertised.",
        "I want to cancel my current subscription immediately.",
        "My refund request is taking too much time.",
        "I want to file a complaint regarding poor service.",
        "The website keeps showing error when placing the order.",
        "My internet speed is slower than the promised package.",
        "I need help to change my registered phone number.",
        "My account was suspended without any prior notice.",
        "I am unable to use my promo code anymore.",
        "The customer support phone line is always busy.",
        "I want to upgrade my current plan next month.",
        "I did not receive the invoice via email.",
        "My package was delivered to the wrong address.",
        "I was charged extra without any clear explanation.",
        "The product warranty details are not available online.",
        "I am facing difficulty tracking my shipment status.",
        "The plan details are unclear and confusing for me.",
        "I want a callback from the support team today.",
        "I submitted documents but my request is still pending.",
        "The delivery agent refused to deliver my package.",
        "I want to change the delivery date to tomorrow.",
        "My device heats up after only a few minutes.",
        "I am unable to sign up using my email.",
        "My issue remains unresolved despite repeated follow-ups.",
        "I am getting too many spam messages recently.",
        "I need help updating my payment information quickly.",
        "The product manual does not explain installation properly.",
        "I need a technician to visit my house soon.",
        "My data plan expired earlier than expected yesterday.",
        "The message says invalid card but details are correct.",
        "I want to check the remaining validity of my plan.",
        "I am unable to redeem my reward points online.",
        "My payment keeps failing even after several attempts.",
        "I need help pairing this device with my phone.",
        "The application freezes when I try uploading documents.",
        "My device is not connecting to the Bluetooth feature.",
        "I am unable to cancel my recurring subscription charges.",
        "The delivery person marked the item as delivered already.",
        "My product arrived late and was poorly packaged.",
        "I want to speak with a senior representative now.",
        "The customer care executive gave incorrect information earlier.",
        "My account shows wrong billing details this month.",
        "I need assistance activating my new prepaid plan.",
        "The replacement product has not arrived yet after approval.",
        "I cannot download the latest software update successfully.",
        "The plan charges shown online are different than advertised.",
        "I want to know why my order was canceled.",
        "My package got damaged while being delivered yesterday.",
        "I cannot unsubscribe because the option is not visible.",
        "I want to transfer my account to a new number.",
        "My reward coupon has expired before its valid date.",
        "I need help with installation of the purchased product.",
        "The tracking number provided is not working properly.",
        "My call was disconnected without any proper resolution.",
        "I want to update my email address on the account.",
        "My replacement request was rejected without any explanation.",
        "The product description on website is misleading and incorrect.",
        "I cannot contact support because chat option is unavailable.",
        "I want to change my current delivery location immediately.",
        "The technician promised a visit but never came.",
        "My bank statement shows an unknown transaction yesterday.",
        "I accidentally ordered twice and need cancellation now.",
        "The support agent asked me to call again later.",
        "My SIM card is not detecting any network now.",
        "I want help transferring data to a new device.",
        "My order was partially delivered missing two items.",
        "I received a faulty unit that does not start.",
        "The password reset link is not opening properly.",
        "I need support to enable my email notifications.",
        "I need help to activate my new SIM card.",
        "I could not connect to customer service despite many attempts.",
        "My device restarts automatically without any warning message.",
        "The service center is too far from my house.",
        "I need clarification on my latest billing statement.",
        "I want to renew my plan for next month.",
        "My product has scratches even though it's brand new.",
        "I cannot find the serial number for registration.",
        "I want to know the available upgrade options.",
        "I need urgent help because the device has stopped working.",
        "The agent promised a refund but nothing has been processed.",
        "My package was returned without any clear reason.",
        "I want to exchange this product for a better model.",
        "I need instructions to set up the smart device.",
        "The live chat support keeps disconnecting after few messages."
    ]

        social_media = [
        "Your new profile picture looks really amazing today.",
        "I think this post deserves way more likes.",
        "Everyone is talking about this trending video now.",
        "I just shared your post with my friends.",
        "This comment section is getting out of control.",
        "I love the positive message in your post.",
        "Can you send me the link to that video?",
        "Your photography skills have improved a lot recently.",
        "The memes today were extremely funny and relatable.",
        "This filter makes the picture look very stylish.",
        "I enjoyed scrolling through your travel pictures yesterday.",
        "People seem to love your cooking videos online.",
        "I saw your story and it looked interesting.",
        "This content creator is becoming really popular everywhere now.",
        "I can't believe how fast this reel went viral.",
        "Your caption is short, simple, and very engaging.",
        "The comments are full of love and positivity.",
        "This dance reel is trending almost everywhere today.",
        "I shared your post because it felt relatable.",
        "Everyone is sharing the same viral clip today.",
        "This video tutorial was helpful and very easy.",
        "Your post inspired me to try something new.",
        "So many people are using this new filter today.",
        "That story made me laugh early this morning.",
        "Your editing style looks very clean and smooth.",
        "Can you please tag the brand you used?",
        "I love the colors in your latest picture.",
        "This audio clip is trending on reels now.",
        "You should definitely post more content like this.",
        "People are posting too much about this topic today.",
        "The comments under this post are hilarious right now.",
        "I follow you because your content is refreshing.",
        "That post reminded me of our old memories.",
        "Your pictures always look so peaceful and beautiful.",
        "This photo deserves more attention and more shares.",
        "I liked your story but forgot to reply.",
        "Please upload that reel again with music.",
        "Your fashion sense seems to get better daily.",
        "This challenge looks fun; I want to try.",
        "Everyone is using the same sound lately.",
        "Your food posts always make me feel hungry.",
        "The message in your post is very meaningful.",
        "I saw this post earlier on another page.",
        "Please send me the link to your channel.",
        "I think this page has great recommendations daily.",
        "Everyone is reacting differently to this trending news.",
        "I loved the playlist you shared yesterday evening.",
        "Your comment got so many likes instantly today.",
        "This video quality looks better than the previous one.",
        "I think your post deserves to be featured.",
        "People are loving this creator’s sense of humor.",
        "I saw your post on my feed first.",
        "That influencer collaborated with a big brand yesterday.",
        "Your story update made me smile this morning.",
        "I can’t stop watching this hilarious video now.",
        "This account always posts the best travel content.",
        "Your handwriting looks beautiful in the recent picture.",
        "That unboxing video was surprisingly very entertaining today.",
        "So many influencers are promoting this product now.",
        "I love the peaceful vibe in your stories.",
        "This reel made my entire day so much better.",
        "You should upload that recipe in long format.",
        "People are sharing memories because of this trend.",
        "This page posts helpful tips almost every day.",
        "I commented but it didn’t show for some reason.",
        "Your dance moves are smooth and really impressive.",
        "I watched that reel multiple times before sleeping.",
        "Your post reached my feed very late today.",
        "I love how creative your content always is.",
        "This wallpaper looks very aesthetic and calming.",
        "I saw your post earlier but forgot to like.",
        "This trend looks interesting but also a little confusing.",
        "Your message in that story felt very emotional.",
        "The comments are funnier than the actual post.",
        "I discovered this artist through your shared story.",
        "People are obsessed with that new dance trend.",
        "I liked your post and saved it too.",
        "The brand collaboration post looks very professional now.",
        "Your channel deserves way more subscribers right now.",
        "I feel this music suits your video perfectly.",
        "People are reposting this clip everywhere on Instagram.",
        "I saw many people using this transition effect.",
        "Your voice sounds so soothing in that video.",
        "This post is simple yet extremely powerful.",
        "I love how natural your expressions look online.",
        "This creator deserves more recognition from everyone.",
        "Your clothing haul video was extremely fun to watch.",
        "I love how organized your highlights look today.",
        "I enjoyed your latest vlog; please post more.",
        "This meme made me laugh early this morning.",
        "Everyone is discussing this controversial post online.",
        "That food review was short but very helpful.",
        "Your vacation pictures look straight out of a movie.",
        "This page always uploads helpful budgeting tips daily.",
        "I like how honest your product reviews are.",
        "That throwback post made me miss old days.",
        "People are commenting faster than I can read.",
        "I love the background music in your reel.",
        "I think you should start posting regularly now.",
        "The comment section looks surprisingly peaceful today.",
        "Your inspirational quote really improved my mood today.",
        "This travel guide video was useful and short.",
        "Everyone is excited about your upcoming content drop.",
        "Your recent post gives a very nostalgic vibe."
    ]

        news_knowledge = [
        "The government announced new guidelines for public safety today.",
        "Scientists discovered a new species in the deep ocean.",
        "The stock market saw significant growth this morning.",
        "A major storm is expected to hit the coastline soon.",
        "Health officials reported a rise in local infection cases.",
        "The election results will be declared later tonight.",
        "A large wildfire continues burning near the national forest.",
        "Researchers developed a new method to store clean energy.",
        "The international summit discussed climate change solutions today.",
        "A new education policy aims to support rural development.",
        "A historic peace agreement was signed earlier this week.",
        "Experts warn that global inflation rates are increasing rapidly.",
        "A new technology promises faster and safer transportation.",
        "The city council approved plans for affordable housing.",
        "Environmental activists protested against illegal mining operations.",
        "Medical teams are working to improve vaccination programs.",
        "A major accident caused traffic delays on the highway.",
        "The central bank raised interest rates this quarter.",
        "Weather forecasts suggest heavy rain across several states.",
        "Experts say renewable energy demand is growing steadily.",
        "A new space mission successfully entered lunar orbit today.",
        "The government launched an initiative to support small businesses.",
        "Scientists confirmed traces of water on a distant planet.",
        "A public survey showed declining trust in social media.",
        "Several countries pledged funds to support global health projects.",
        "Researchers created a new tool to detect early diseases.",
        "Authorities are investigating reports of financial fraud downtown.",
        "A new library opened to encourage youth education.",
        "The environmental agency issued warnings about poor air quality.",
        "Trade negotiations continued without any major progress reported.",
        "A powerful earthquake shook cities across the northern region.",
        "A new art exhibition attracted thousands of visitors today.",
        "The police arrested suspects involved in illegal trafficking.",
        "A new bridge will reduce travel time between cities.",
        "The aviation industry expects strong recovery next year.",
        "Health experts encourage people to adopt balanced diets.",
        "A volunteer program aims to support disabled children.",
        "Economists predict slower economic growth next quarter.",
        "A recent study linked sleep habits with mental health.",
        "New safety measures were announced for public transport.",
        "The football team won an important match yesterday.",
        "International markets reacted strongly to currency fluctuations.",
        "A rare celestial event will be visible tomorrow night.",
        "New farming technology helps increase crop productivity safely.",
        "Lawmakers promised reforms after widespread citizen protests.",
        "The annual cultural festival attracted visitors from many countries.",
        "New research shows benefits of plant-based diets increasing.",
        "A city cleanup drive began across several localities.",
        "Wildlife conservation efforts have shown encouraging results recently.",
        "The new airport terminal will open next summer.",
        "Local authorities introduced digital systems for easier documentation.",
        "A new museum highlights indigenous history and art.",
        "The railway network announced upgraded high-speed train routes.",
        "Researchers found a strong link between pollution and anxiety.",
        "A major water pipeline project will start next month.",
        "Experts highlighted the importance of cybersecurity training programs.",
        "Record temperatures were reported across multiple regions today.",
        "Scientists identified genes linked to rare health disorders.",
        "A new recycling plant opened to manage plastic waste.",
        "Thousands participated in the national marathon this weekend.",
        "The power grid experienced outages due to equipment failure.",
        "Experts predict rising sea levels over the coming decades.",
        "The tourism sector is recovering steadily after recent challenges.",
        "A local company launched an affordable electric scooter model.",
        "New archaeological findings reveal details about ancient civilizations.",
        "The education board announced changes in exam patterns.",
        "Rising fuel prices impacted transport services across major cities.",
        "The council proposed stricter rules to protect heritage sites.",
        "A massive crowd gathered to celebrate the annual parade.",
        "A global conference explored new solutions to hunger.",
        "The mayor promised action against illegal construction activities.",
        "Scientists developed an eco-friendly material to replace plastic.",
        "Authorities closed schools due to dangerous weather alerts.",
        "New laws aim to improve data privacy protection.",
        "The country hosted an international sports event this week.",
        "Researchers found encouraging results in cancer treatment trials.",
        "A large donation fund was created to support flood victims.",
        "The art community mourned the loss of a famous painter.",
        "Environmentalists demanded stronger action to protect forests.",
        "Local farmers protested against rising fertilizer costs yesterday.",
        "A new biotech startup focuses on medical innovation.",
        "Experts say rising temperatures threaten major crop yields.",
        "Traffic rules will be stricter from next month onward.",
        "A major software outage affected several essential services.",
        "A new digital tax policy will begin next year.",
        "The health ministry approved emergency funding for rural hospitals.",
        "Researchers discovered new fossils in a remote mountain region.",
        "A famous author released a new book this month.",
        "The global economy shows signs of slow but steady recovery.",
        "A coastal town prepared shelters for incoming cyclone warnings.",
        "A major cyberattack targeted government data systems overnight.",
        "Scientists developed new battery technology with longer durability.",
        "The country plans to invest heavily in renewable energy.",
        "The transport department added more buses for commuters.",
        "A new documentary explores life in remote tribal regions.",
        "Authorities advised citizens to conserve water during summer months.",
        "Technology firms announced large-scale hiring for upcoming projects.",
        "A report suggested major improvements in the healthcare system.",
        "A science festival encouraged students to share innovative ideas.",
        "The national park reopened after extensive restoration work.",
        "Meteorologists predict reduced rainfall throughout the coming season."
    ]

        education = [
        "I need to prepare thoroughly for my physics exam tomorrow.",
        "She studies every evening to improve her math skills.",
        "Our teacher assigned a long homework task today.",
        "The school library has many useful reference books.",
        "I want to understand this concept more clearly.",
        "He explained the chemistry problem step by step.",
        "Students are expected to complete all assignments on time.",
        "The online class started late due to technical issues.",
        "She revised all chapters before the final examination.",
        "We discussed the importance of discipline in learning.",
        "The professor provided detailed notes for the lecture.",
        "Group discussions help students understand complex topics well.",
        "I forgot to submit my homework last night.",
        "My friend helped me solve difficult algebra problems.",
        "The practical exam will be conducted next Monday.",
        "Our teacher encouraged us to ask more questions.",
        "The class monitor collected all assignments from students.",
        "He likes to study in a quiet environment.",
        "Most students struggle with understanding organic chemistry chapters.",
        "She uses flashcards to memorize important science terms.",
        "The syllabus includes several advanced mathematical theories.",
        "I want guidance to choose the right career.",
        "We will have a surprise quiz next week.",
        "The library is a good place to focus.",
        "The school introduced new methods to improve learning outcomes.",
        "Students must bring calculators for tomorrow’s test.",
        "He wants to apply to a top engineering college.",
        "She needs help understanding trigonometric functions properly.",
        "We visited the science lab for experiments today.",
        "The teacher explained grammar rules using simple examples.",
        "He usually studies early in the morning every day.",
        "I want to join the advanced programming course soon.",
        "She attended a workshop about public speaking skills.",
        "They are preparing a presentation for the biology project.",
        "Our principal announced new changes in the curriculum.",
        "He practices reading daily to improve his vocabulary.",
        "Students must maintain discipline inside the classroom always.",
        "We solved several sample papers before the board exams.",
        "The teacher asked us to summarize the lesson.",
        "I find it difficult to remember historical dates.",
        "She aims to clear medical entrance exams next year.",
        "I studied online tutorials to learn basic coding.",
        "He wants to improve his English communication skills.",
        "We were given time to revise the chapter.",
        "The math teacher explained different types of equations.",
        "Students are encouraged to participate in cultural activities.",
        "I missed the lecture and need the notes.",
        "She finished her assignment before the deadline yesterday.",
        "The school organized a debate competition this afternoon.",
        "They discussed the importance of environmental education today.",
        "He requested clarification about the project instructions.",
        "My tutor helped me understand calculus better.",
        "We will learn about world history next month.",
        "Students must follow all exam hall guidelines strictly.",
        "I need better time management during the exam.",
        "She practices handwriting to improve her writing speed.",
        "We are learning about human anatomy this semester.",
        "The teacher gave feedback on our project presentation.",
        "He attends coaching classes to prepare for entrance exams.",
        "I study in groups to share knowledge effectively.",
        "She is working hard to improve her grade this year.",
        "The exam results will be announced next Friday.",
        "Students often face difficulty understanding chemical reactions.",
        "The classroom environment helps improve student concentration effectively.",
        "The teacher asked us to write an essay.",
        "I have trouble remembering formulas for the physics test.",
        "She wants help solving the geometry exercise problems.",
        "We were taught the basics of computer programming.",
        "The principal awarded top performers in the examination.",
        "He spends weekends preparing for competitive exams.",
        "I need to buy new textbooks this semester.",
        "The lecturer used real examples to explain economics.",
        "Students discussed their doubts after the math class.",
        "He is planning to join a coaching institute.",
        "Our tutor gives personal guidance to every student.",
        "The assignment submission date has been extended now.",
        "My friend shared helpful notes from the last lecture.",
        "We must study regularly to score good marks.",
        "She organized her notes to revise efficiently.",
        "The teacher encouraged us to participate more actively.",
        "The college announced new scholarships for deserving students.",
        "I want to improve my note-taking skills soon.",
        "He completed all chapters before the midterm exams.",
        "Our team prepared a report about renewable energy.",
        "Students visited the museum to learn ancient history.",
        "I asked for extra classes before the final exam.",
        "She wants to become a science researcher someday.",
        "We discussed new learning strategies with our teacher.",
        "The lecture covered basics of quantum physics today.",
        "He needs practice solving long mathematical problems quickly.",
        "She is attending online coaching for competitive tests.",
        "Students must submit project reports before the deadline.",
        "I need help understanding photosynthesis thoroughly.",
        "He prefers studying late at night when quiet.",
        "Our teacher showed us a helpful video tutorial.",
        "They took notes while the professor taught economics.",
        "We visited the university campus for admission counseling.",
        "The teacher explained the practical experiment procedure clearly.",
        "She writes summaries after studying each chapter carefully.",
        "I learned new concepts from the latest workshop.",
        "He prepares a weekly schedule for efficient study.",
        "The class reviewed previous exam papers together yesterday.",
        "Students were advised to maintain healthy study habits."
    ]







        examples = []
        for text in casual_chat:
            examples.append({"text": _normalize_space(text), "domain": "casual_chat"})
        for text in daily_routines:
            examples.append({"text": _normalize_space(text), "domain": "daily_routines"})
        for text in logistics_travel:
            examples.append({"text": _normalize_space(text), "domain": "travel"})
        for text in commerce_shopping:
            examples.append({"text": _normalize_space(text), "domain": "shopping"})
        for text in customer_support:
            examples.append({"text": _normalize_space(text), "domain": "customer_support"})
        for text in social_media:
            examples.append({"text": _normalize_space(text), "domain": "social_media"})
        for text in news_knowledge:
            examples.append({"text": _normalize_space(text), "domain": "news_knowledge"})
        for text in education:
            examples.append({"text": _normalize_space(text), "domain": "education"})
        return examples

    # ---------------------------------------------------------------
    # CONTROL CONFIG GENERATION
    # ---------------------------------------------------------------
    def generate_control_configs(self) -> List:
        """Generate diverse control configurations"""
        configs = []

        cmi_values = [0.2, 0.6, 0.8, 0.95]
        formality_values = [round(x/10, 1) for x in range(1, 10)]
        domains = ['casual_chat', 'daily_routines', 'logistics_travel', 'commerce_shopping', 'customer_support', 'social_media', 'news_knowledge','education']

        for cmi in cmi_values:
            for formality in formality_values:
                for domain in domains:
                    configs.append(
                        ControlConfig(
                            target_language="Hindi",
                            cmi_target=cmi,
                            formality=formality,
                            domain=domain,
                        )
                    )

        random.shuffle(configs)
        return configs

    # ---------------------------------------------------------------
    # AUGMENTATION HOOKS (light, plug-in)
    # ---------------------------------------------------------------
    def _phonetic_variation(self, text: str, control) -> str:
        """Small hook → replace with richer version externally."""
        if control.formality > 0.6:
            return text
        # simple example
        reps = {
            "nahi": ["nai", "nhi", "nahi"],
            "main": ["main", "mein"],
        }
        words = text.split()
        out = []
        for w in words:
            lw = w.lower()
            if lw in reps and random.random() < 0.25:
                out.append(random.choice(reps[lw]))
            else:
                out.append(w)
        return " ".join(out)

    def _add_slang(self, text: str, control) -> str:
        if control.formality > 0.4:
            return text
        if random.random() < 0.1:
            return text + " lol"
        return text

    def _add_discourse_marker(self, text: str, control) -> str:
        if control.formality > 0.5:
            return text
        if random.random() < 0.15:
            return text + " yaar"
        return text

    # ---------------------------------------------------------------
    # FILTERS
    # ---------------------------------------------------------------
    def _valid(self, ex: Dict) -> bool:
        """Check duplicates + profanity + min length"""
        text = ex.get("output", "")
        if len(text.split()) < 2:
            return False
        if PROFANITY_RE.search(text.lower()):
            return False
        h = _hash_text(text)
        if h in self.seen:
            return False
        self.seen.add(h)
        return True

    # ---------------------------------------------------------------
    # BUILD DATASET
    # ---------------------------------------------------------------
    def build_dataset(self, num_examples_target: int = 1000, num_variants: int = 3) -> List[Dict]:
        """Build complete instruction dataset with multiple variants"""

        # -----------------------------------------------------------
        # Load curated if exists
        # -----------------------------------------------------------
        if self.curated_file:
            try:
                with open(self.curated_file, "r", encoding="utf-8") as f:
                    for line in f:
                        ex = json.loads(line.strip())
                        if all(k in ex for k in ["instruction", "input", "output", "control"]):
                            if self._valid(ex):
                                self.dataset.append(ex)
            except FileNotFoundError:
                print(f"Curated file not found: {self.curated_file}")
            except Exception as e:
                print(f"Error loading curated examples: {e}")

        # -----------------------------------------------------------
        base_examples = self.get_base_examples()
        control_configs = self.generate_control_configs()

        print(f"Generating from {len(base_examples)} base examples × {len(control_configs)} configs")

        # -----------------------------------------------------------
        # Main Loop
        # -----------------------------------------------------------
        stop = False
        for base_ex in tqdm(base_examples, desc="Generating"):
            for control in control_configs:
                for v in range(num_variants):

                    if len(self.dataset) >= num_examples_target:
                        stop = True
                        break

                    # augment input
                    input_text = base_ex["text"]
                    input_text = self._phonetic_variation(input_text, control)
                    input_text = self._add_discourse_marker(input_text, control)
                    input_text = self._add_slang(input_text, control)

                    # call generative model
                    np.random.seed()   # vary sampling
                    output = self.generator.generate(input_text, control)

                    example = {
                        "instruction": control.to_instruction(),
                        "input": input_text,
                        "output": output,
                        "control": asdict(control),
                        "domain": base_ex["domain"]
                    }

                    if self._valid(example):
                        self.dataset.append(example)

                if stop:
                    break
            if stop:
                break

        return self.dataset

   
    def save_and_split(self, train_ratio=0.8, val_ratio=0.1, drive_folder="your_project/splits"):
        """Save dataset, create splits, and upload to Google Drive"""

        # ---- Mount Drive once ----
        drive.mount('/content/drive')

        # ---- Calculate splits ----
        total = len(self.dataset)
        train_size = int(total * train_ratio)
        val_size = int(total * val_ratio)

        random.shuffle(self.dataset)
        train = self.dataset[:train_size]
        val = self.dataset[train_size:train_size + val_size]
        test = self.dataset[train_size + val_size:]

        # ---- Local folder ----
        local_dir = "data/splits"
        os.makedirs(local_dir, exist_ok=True)

        # ---- Google Drive folder ----
        drive_dir = f"/content/drive/My Drive/{drive_folder}"
        os.makedirs(drive_dir, exist_ok=True)

        # ---- Save to local + Drive ----
        for name, data in [("train", train), ("val", val), ("test", test)]:
            local_path = f"{local_dir}/{name}.jsonl"
            drive_path = f"{drive_dir}/{name}.jsonl"

            # Save locally
            with open(local_path, "w", encoding="utf-8") as f:
                for ex in data:
                    f.write(json.dumps(ex, ensure_ascii=False) + "\n")

            # Copy to Google Drive
            with open(drive_path, "w", encoding="utf-8") as f:
                for ex in data:
                    f.write(json.dumps(ex, ensure_ascii=False) + "\n")

            print(f"✓ Saved {name}.jsonl to:")
            print("   -", local_path)
            print("   -", drive_path)

        print(f"\n✓ Split complete: train={len(train)}, val={len(val)}, test={len(test)}")
        return train, val, test



# Build dataset
dataset_builder = DatasetBuilder(generator)
dataset = dataset_builder.build_dataset(num_examples_target=50000)
train_data, val_data, test_data = dataset_builder.save_and_split()

print(f"\n✓ Total dataset: {len(dataset)} examples")
print(f"Sample output: {dataset[0]['output']}")

## Part 1 done

"""# Part 1 done"""

drive.mount('/content/drive')

def load_jsonl(path):
    data = []
    with jsonlines.open(path) as reader:
        for obj in reader:
            data.append(obj)
    return data

BASE = "/content/drive/My Drive/your_project/your_project/splits"

train = load_jsonl(f"{BASE}/train.jsonl")
val   = load_jsonl(f"{BASE}/val.jsonl")
test  = load_jsonl(f"{BASE}/test.jsonl")

print("Loaded:", len(train), "train |", len(val), "val |", len(test), "test")

MODEL_NAME = "TheBloke/Mistral-7B-Instruct-v0.2-AWQ"

def build_prompt(example):
    return f"""
You are a Hinglish cleaner. Improve the noisy generated text while keeping:
- Same meaning as INPUT
- Same Hindi-English mix
- Same informal social media style
- More coherent and natural
- Strictly generate only the output text
- Dont add any explanation
- Dont give multiple outputs
- Dont return the original text

Here is an example for you:
actual_english: I plan weekend activities with my family regularly.
noisy_output: I honaaaa kaam activities with my parivaar regularly.
cleaned_output: Main apne parivaar se weekend activities plan karta hoon.

Strictly generate only the output text, dont add any explanation, dont give multiple outputs and dont return the original text. Be strict improver.

### Input:
{example['input']}

### Noisy Output:
{example['output']}


### Cleaned Text:
""".strip()

from vllm import LLM, SamplingParams

llm = LLM(
    model=MODEL_NAME,
    tokenizer=MODEL_NAME,
    tensor_parallel_size=1,
    dtype="auto",
    quantization="AWQ",
    trust_remote_code=True,
    gpu_memory_utilization=0.75,
    max_model_len=2048,            # <<< Major memory saver
)

sampling_params = SamplingParams(
    temperature=0.45,
    top_p=0.9,
    max_tokens=80
)

def predict_vllm(dataset):
    prompts = [build_prompt(ex) for ex in dataset]
    outputs = llm.generate(prompts, sampling_params)

    results = []
    for ex, out in zip(dataset, outputs):
        full_text = out.outputs[0].text.strip()

        cleaned = full_text.split("### Cleaned Text:")[-1].strip()

        results.append({
            "input": ex["input"],
            "original_output": ex["output"],
            "cleaned_output": cleaned,
            "control": ex.get("control", {}),
            "domain": ex.get("domain", "")
        })
    return results

clean_train = predict_vllm(train)
clean_val   = predict_vllm(val)
clean_test  = predict_vllm(test)

# clean_test

def save_jsonl(path, data):
    with jsonlines.open(path, mode="w") as writer:
        for obj in data:
            writer.write(obj)

save_jsonl(f"{BASE}/cleaned_train.jsonl", clean_train)
save_jsonl(f"{BASE}/cleaned_val.jsonl", clean_val)
save_jsonl(f"{BASE}/cleaned_test.jsonl", clean_test)

print("\nSaved cleaned dataset files:")
print(f"- {BASE}/cleaned_train.jsonl")
print(f"- {BASE}/cleaned_val.jsonl")
print(f"- {BASE}/cleaned_test.jsonl")






